# Tillson T3 Moving Average (T3)

The Tillson T3 is a sophisticated moving average developed by Tim Tillson that provides excellent smoothness with minimal lag. It uses a unique algorithm involving multiple exponential moving averages with a volume factor to achieve superior performance.

## Formula

The T3 is calculated using six exponential smoothings with a volume factor (vfactor) that controls the smoothness versus responsiveness trade-off:

T3 = c1 * e6 + c2 * e5 + c3 * e4 + c4 * e3

Where e1 through e6 are successive EMAs, and c1-c4 are coefficients derived from the volume factor.

## Parameters

| Parameter | Type | Required | Default | Description |
|-----------|------|----------|---------|-------------|
| `prices` | Array<Float> | Yes | - | Array of price values |
| `period` | Integer | No | 5 | Number of periods for calculation |
| `vfactor` | Float | No | 0.7 | Volume factor (0 to 1) controlling smoothness |

## Returns

Returns an array of T3 values. The first several values will be `nil` due to the multiple smoothing calculations.

## Usage

```ruby
require 'sqa/tai'

prices = [44.34, 44.09, 44.15, 43.61, 44.33, 44.83,
          45.10, 45.42, 45.84, 46.08, 46.03, 46.41,
          46.22, 45.64, 46.21, 46.25, 46.08, 46.46,
          46.82, 47.00, 47.32, 47.20, 47.57, 47.80,
          48.00, 48.15, 48.30, 48.40, 48.55, 48.70]

# Calculate T3 with default parameters
t3 = SQA::TAI.t3(prices)

# Calculate with custom period
t3_10 = SQA::TAI.t3(prices, period: 10)

# Calculate with different vfactor for more/less smoothness
t3_smooth = SQA::TAI.t3(prices, period: 5, vfactor: 0.9)   # More smooth
t3_responsive = SQA::TAI.t3(prices, period: 5, vfactor: 0.5) # More responsive

puts "Current T3: #{t3.last.round(2)}"
```

## Volume Factor (vfactor) Guide

The vfactor parameter controls the balance between smoothness and responsiveness:

| vfactor | Characteristics | Best For |
|---------|----------------|----------|
| 0.0 - 0.3 | Very responsive, more noise | Scalping, very short-term |
| 0.4 - 0.6 | Balanced response | Day trading |
| 0.7 (default) | Smooth with good response | Swing trading, general use |
| 0.8 - 1.0 | Very smooth, slower | Position trading, long-term |

## Interpretation

The T3 provides clear trend signals with minimal noise:

- **Price above T3**: Bullish trend
- **Price below T3**: Bearish trend
- **T3 slope upward**: Uptrend strength
- **T3 slope downward**: Downtrend strength
- **Flat T3**: Consolidation or range-bound

## Example: T3 Trend Trading

```ruby
prices = load_historical_prices('AAPL')
t3 = SQA::TAI.t3(prices, period: 8, vfactor: 0.7)

current_price = prices.last
current_t3 = t3.last

# Calculate T3 slope over last 3 bars
t3_slope = current_t3 - t3[-3]
slope_pct = (t3_slope / t3[-3] * 100).round(2)

if current_price > current_t3 && t3_slope > 0
  puts "STRONG UPTREND"
  puts "Price above rising T3 (slope: +#{slope_pct}%)"
  puts "Action: HOLD LONG / BUY PULLBACKS"
elsif current_price < current_t3 && t3_slope < 0
  puts "STRONG DOWNTREND"
  puts "Price below falling T3 (slope: #{slope_pct}%)"
  puts "Action: HOLD SHORT / SELL RALLIES"
elsif current_price > current_t3 && t3_slope < 0
  puts "WEAKENING TREND"
  puts "Price above but T3 falling - potential reversal"
elsif current_price < current_t3 && t3_slope > 0
  puts "BUILDING MOMENTUM"
  puts "Price below but T3 rising - watch for breakout"
end
```

## Example: T3 Crossover System

```ruby
prices = load_historical_prices('SPY')

# Fast T3 with lower vfactor (more responsive)
t3_fast = SQA::TAI.t3(prices, period: 5, vfactor: 0.5)

# Slow T3 with higher vfactor (more smooth)
t3_slow = SQA::TAI.t3(prices, period: 13, vfactor: 0.8)

# Check for crossover
if t3_fast[-2] <= t3_slow[-2] && t3_fast[-1] > t3_slow[-1]
  puts "BULLISH CROSSOVER"
  puts "Fast T3 crossed above Slow T3"
  puts "Signal: BUY"
elsif t3_fast[-2] >= t3_slow[-2] && t3_fast[-1] < t3_slow[-1]
  puts "BEARISH CROSSOVER"
  puts "Fast T3 crossed below Slow T3"
  puts "Signal: SELL"
end

# Calculate separation
separation_pct = ((t3_fast.last - t3_slow.last) / t3_slow.last * 100).round(2)
puts "T3 Separation: #{separation_pct}%"
```

## Example: T3 with Dynamic Bands

```ruby
prices = load_historical_prices('TSLA')
t3 = SQA::TAI.t3(prices, period: 10, vfactor: 0.7)

# Calculate ATR for dynamic band width
atr = SQA::TAI.atr(
  prices.map { |p| p * 1.01 },  # Approximate high
  prices.map { |p| p * 0.99 },  # Approximate low
  prices,
  period: 14
)

# Create bands at Â±2 ATR from T3
upper_band = t3.last(20).zip(atr.last(20)).map do |t3_val, atr_val|
  next nil if t3_val.nil? || atr_val.nil?
  t3_val + (2 * atr_val)
end

lower_band = t3.last(20).zip(atr.last(20)).map do |t3_val, atr_val|
  next nil if t3_val.nil? || atr_val.nil?
  t3_val - (2 * atr_val)
end

current_price = prices.last

if current_price > upper_band.compact.last
  puts "Price above upper T3 band - overbought"
elsif current_price < lower_band.compact.last
  puts "Price below lower T3 band - oversold"
else
  puts "Price within T3 bands - normal range"
end
```

## Example: Optimizing vfactor for Market Conditions

```ruby
prices = load_historical_prices('MSFT')

# Test different vfactors
vfactors = [0.3, 0.5, 0.7, 0.9]

vfactors.each do |vf|
  t3 = SQA::TAI.t3(prices, period: 8, vfactor: vf)

  # Calculate how closely T3 follows price
  recent_prices = prices.last(20).compact
  recent_t3 = t3.last(20).compact

  next if recent_t3.empty?

  avg_distance = recent_prices.zip(recent_t3).map do |p, t|
    ((p - t).abs / t * 100)
  end.sum / recent_prices.size

  puts "vfactor #{vf}: Avg distance from price: #{avg_distance.round(2)}%"
end

puts "\nLower distance = more responsive"
puts "Higher distance = more smooth"
```

## Advantages

1. **Excellent Smoothness**: One of the smoothest indicators available
2. **Low Lag**: Despite smoothness, maintains good responsiveness
3. **Customizable**: vfactor allows tuning for different markets
4. **Clear Signals**: Reduced noise means fewer false signals
5. **Versatile**: Works across all timeframes and markets

## Common Settings

| Period | vfactor | Use Case |
|--------|---------|----------|
| 5 | 0.7 | Short-term trading (default) |
| 8 | 0.6-0.8 | Day trading |
| 13 | 0.7-0.9 | Swing trading |
| 21 | 0.8-1.0 | Position trading |

## Best Practices

1. **Start with defaults**: Period 5, vfactor 0.7 works well for most cases
2. **Adjust vfactor for volatility**: Higher in choppy markets, lower in trending
3. **Use with price action**: Confirm T3 signals with support/resistance
4. **Multiple timeframes**: Check T3 alignment across timeframes
5. **Combine with momentum**: Use with RSI or MACD for confirmation

## Related Indicators

- [EMA](ema.md) - Exponential Moving Average
- [DEMA](dema.md) - Double Exponential Moving Average
- [TEMA](tema.md) - Triple Exponential Moving Average
- [KAMA](kama.md) - Kaufman Adaptive Moving Average

## See Also

- [Back to Indicators](../index.md)
- [Overlap Studies Overview](../index.md)
