
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Ruby wrapper for TA-Lib - 200+ Technical Analysis Indicators">
      
      
        <meta name="author" content="Dewayne VanHoozer">
      
      
        <link rel="canonical" href="https://madbomber.github.io/sqa-tai/indicators/volatility/ht_trendline/">
      
      
      
      
        
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>HT_TRENDLINE (Hilbert Transform - Instantaneous Trendline) - SQA TAI - Technical Analysis Indicators</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.618322db.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/css/custom.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#ht_trendline-hilbert-transform-instantaneous-trendline" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="SQA TAI - Technical Analysis Indicators" class="md-header__button md-logo" aria-label="SQA TAI - Technical Analysis Indicators" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            SQA TAI - Technical Analysis Indicators
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              HT_TRENDLINE (Hilbert Transform - Instantaneous Trendline)
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="blue"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="blue"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/MadBomber/sqa-tai" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    madbomber/sqa-tai
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../getting-started/installation/" class="md-tabs__link">
          
  
  
    
  
  Getting Started

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../" class="md-tabs__link">
          
  
  
    
  
  Indicators

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../api-reference/" class="md-tabs__link">
        
  
  
    
  
  API Reference

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../examples/trend-analysis/" class="md-tabs__link">
          
  
  
    
  
  Examples

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../contributing/" class="md-tabs__link">
        
  
  
    
  
  Contributing

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="SQA TAI - Technical Analysis Indicators" class="md-nav__button md-logo" aria-label="SQA TAI - Technical Analysis Indicators" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    SQA TAI - Technical Analysis Indicators
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/MadBomber/sqa-tai" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    madbomber/sqa-tai
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Getting Started
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Getting Started
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../getting-started/installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Installation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../getting-started/quick-start/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quick Start
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../getting-started/basic-usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Basic Usage
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Indicators
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Indicators
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Overlap Studies
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Overlap Studies
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../overlap/sma/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Simple Moving Average
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../overlap/ema/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Exponential Moving Average
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../overlap/wma/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Weighted Moving Average
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../overlap/bbands/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Bollinger Bands
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Momentum
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Momentum
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../momentum/rsi/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    RSI
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../momentum/macd/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MACD
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../momentum/stoch/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Stochastic
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../momentum/mom/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Momentum
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Volatility
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Volatility
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../atr/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Average True Range
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../trange/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    True Range
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5" >
        
          
          <label class="md-nav__link" for="__nav_3_5" id="__nav_3_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Volume
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Volume
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../volume/obv/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    On Balance Volume
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../volume/ad/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chaikin A/D Line
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../patterns/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Patterns
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_6" id="__nav_3_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Patterns
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../patterns/cdl_doji/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Doji
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../patterns/cdl_hammer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Hammer
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../patterns/cdl_engulfing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Engulfing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../api-reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    API Reference
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Examples
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Examples
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/trend-analysis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Trend Analysis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/momentum-trading/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Momentum Trading
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/volatility-analysis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Volatility Analysis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../contributing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Contributing
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  

<nav class="md-nav md-nav--secondary" aria-label="On this page">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      On this page
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        Overview
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Parameters
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Parameters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#parameter-details" class="md-nav__link">
    <span class="md-ellipsis">
      
        Parameter Details
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usage" class="md-nav__link">
    <span class="md-ellipsis">
      
        Usage
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Usage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic-usage" class="md-nav__link">
    <span class="md-ellipsis">
      
        Basic Usage
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#practical-application" class="md-nav__link">
    <span class="md-ellipsis">
      
        Practical Application
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#understanding-the-indicator" class="md-nav__link">
    <span class="md-ellipsis">
      
        Understanding the Indicator
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Understanding the Indicator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-it-measures" class="md-nav__link">
    <span class="md-ellipsis">
      
        What It Measures
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#why-its-important" class="md-nav__link">
    <span class="md-ellipsis">
      
        Why It's Important
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#calculation-method" class="md-nav__link">
    <span class="md-ellipsis">
      
        Calculation Method
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#indicator-characteristics" class="md-nav__link">
    <span class="md-ellipsis">
      
        Indicator Characteristics
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#interpretation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Interpretation
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Interpretation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#price-position-relative-to-trendline" class="md-nav__link">
    <span class="md-ellipsis">
      
        Price Position Relative to Trendline
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crossover-signals" class="md-nav__link">
    <span class="md-ellipsis">
      
        Crossover Signals
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trendline-slope-and-distance" class="md-nav__link">
    <span class="md-ellipsis">
      
        Trendline Slope and Distance
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trading-signals" class="md-nav__link">
    <span class="md-ellipsis">
      
        Trading Signals
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Trading Signals">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#crossover-trading-strategy" class="md-nav__link">
    <span class="md-ellipsis">
      
        Crossover Trading Strategy
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trend-following-with-pullbacks" class="md-nav__link">
    <span class="md-ellipsis">
      
        Trend Following with Pullbacks
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dynamic-stop-loss-management" class="md-nav__link">
    <span class="md-ellipsis">
      
        Dynamic Stop Loss Management
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      
        Best Practices
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Best Practices">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#optimal-use-cases" class="md-nav__link">
    <span class="md-ellipsis">
      
        Optimal Use Cases
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#combining-with-other-indicators" class="md-nav__link">
    <span class="md-ellipsis">
      
        Combining with Other Indicators
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#common-pitfalls" class="md-nav__link">
    <span class="md-ellipsis">
      
        Common Pitfalls
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strategy-guidelines" class="md-nav__link">
    <span class="md-ellipsis">
      
        Strategy Guidelines
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#practical-example" class="md-nav__link">
    <span class="md-ellipsis">
      
        Practical Example
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#related-indicators" class="md-nav__link">
    <span class="md-ellipsis">
      
        Related Indicators
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Related Indicators">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hilbert-transform-family" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hilbert Transform Family
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#complementary-indicators" class="md-nav__link">
    <span class="md-ellipsis">
      
        Complementary Indicators
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alternative-adaptive-indicators" class="md-nav__link">
    <span class="md-ellipsis">
      
        Alternative Adaptive Indicators
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-topics" class="md-nav__link">
    <span class="md-ellipsis">
      
        Advanced Topics
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Advanced Topics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#comparing-adaptive-vs-fixed-trendlines" class="md-nav__link">
    <span class="md-ellipsis">
      
        Comparing Adaptive vs Fixed Trendlines
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multi-timeframe-trendline-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      
        Multi-Timeframe Trendline Analysis
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trendline-as-dynamic-supportresistance" class="md-nav__link">
    <span class="md-ellipsis">
      
        Trendline as Dynamic Support/Resistance
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#volatility-adjusted-trendline-channels" class="md-nav__link">
    <span class="md-ellipsis">
      
        Volatility-Adjusted Trendline Channels
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      
        References
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#see-also" class="md-nav__link">
    <span class="md-ellipsis">
      
        See Also
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
                



  


              
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/MadBomber/sqa-tai/edit/main/docs/indicators/volatility/ht_trendline.md" title="Edit this page" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/MadBomber/sqa-tai/raw/main/docs/indicators/volatility/ht_trendline.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


<h1 id="ht_trendline-hilbert-transform-instantaneous-trendline">HT_TRENDLINE (Hilbert Transform - Instantaneous Trendline)<a class="headerlink" href="#ht_trendline-hilbert-transform-instantaneous-trendline" title="Permanent link">&para;</a></h1>
<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">&para;</a></h2>
<p>The Hilbert Transform - Instantaneous Trendline (HT_TRENDLINE) is an adaptive trendline indicator that automatically adjusts to the current market cycle. Unlike traditional moving averages with fixed periods, HT_TRENDLINE dynamically adapts to the dominant market cycle length, providing a trendline that responds appropriately to current market conditions. This results in less lag during trends and better responsiveness during cycle changes, making it superior to fixed-period moving averages for trend identification and following.</p>
<h2 id="parameters">Parameters<a class="headerlink" href="#parameters" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>prices</code></td>
<td>Array<Float></td>
<td>Required</td>
<td>Array of price values (typically close prices)</td>
</tr>
</tbody>
</table>
<h3 id="parameter-details">Parameter Details<a class="headerlink" href="#parameter-details" title="Permanent link">&para;</a></h3>
<p><strong>prices</strong>
- Input data should be an array of closing prices
- Minimum 32 data points required for reliable results (due to Hilbert Transform calculation requirements)
- More data provides better accuracy and stability
- Works best with at least 63+ data points for stable adaptive trendline
- The indicator automatically detects the current market cycle and adapts the trendline smoothing accordingly</p>
<h2 id="usage">Usage<a class="headerlink" href="#usage" title="Permanent link">&para;</a></h2>
<h3 id="basic-usage">Basic Usage<a class="headerlink" href="#basic-usage" title="Permanent link">&para;</a></h3>
<div class="language-ruby highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nb">require</span><span class="w"> </span><span class="s1">&#39;sqa/tai&#39;</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="c1"># Calculate adaptive trendline</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="n">prices</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="mi">44</span><span class="o">.</span><span class="mi">34</span><span class="p">,</span><span class="w"> </span><span class="mi">44</span><span class="o">.</span><span class="mi">09</span><span class="p">,</span><span class="w"> </span><span class="mi">44</span><span class="o">.</span><span class="mi">15</span><span class="p">,</span><span class="w"> </span><span class="mi">43</span><span class="o">.</span><span class="mi">61</span><span class="p">,</span><span class="w"> </span><span class="mi">44</span><span class="o">.</span><span class="mi">33</span><span class="p">,</span><span class="w"> </span><span class="mi">44</span><span class="o">.</span><span class="mi">83</span><span class="p">,</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="w">          </span><span class="mi">45</span><span class="o">.</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">45</span><span class="o">.</span><span class="mi">42</span><span class="p">,</span><span class="w"> </span><span class="mi">45</span><span class="o">.</span><span class="mi">84</span><span class="p">,</span><span class="w"> </span><span class="mi">46</span><span class="o">.</span><span class="mi">08</span><span class="p">,</span><span class="w"> </span><span class="mi">46</span><span class="o">.</span><span class="mo">03</span><span class="p">,</span><span class="w"> </span><span class="mi">45</span><span class="o">.</span><span class="mi">61</span><span class="p">,</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="w">          </span><span class="mi">46</span><span class="o">.</span><span class="mi">50</span><span class="p">,</span><span class="w"> </span><span class="mi">47</span><span class="o">.</span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">46</span><span class="o">.</span><span class="mi">80</span><span class="p">,</span><span class="w"> </span><span class="mi">47</span><span class="o">.</span><span class="mi">50</span><span class="p">,</span><span class="w"> </span><span class="mi">48</span><span class="o">.</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">48</span><span class="o">.</span><span class="mi">30</span><span class="p">,</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="w">          </span><span class="c1"># ... more data points ...</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="w">         </span><span class="o">]</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="n">trendline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SQA</span><span class="o">::</span><span class="no">TAI</span><span class="o">.</span><span class="n">ht_trendline</span><span class="p">(</span><span class="n">prices</span><span class="p">)</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="c1"># Compare current price to adaptive trendline</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="n">current_price</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">prices</span><span class="o">.</span><span class="n">last</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="n">current_trendline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">trendline</span><span class="o">.</span><span class="n">last</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="k">if</span><span class="w"> </span><span class="n">current_price</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">current_trendline</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="w">  </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Price above trendline: UPTREND&quot;</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="w">  </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Price: </span><span class="si">#{</span><span class="n">current_price</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="w">  </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Trendline: </span><span class="si">#{</span><span class="n">current_trendline</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="k">else</span>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="w">  </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Price below trendline: DOWNTREND&quot;</span>
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="w">  </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Price: </span><span class="si">#{</span><span class="n">current_price</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="w">  </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Trendline: </span><span class="si">#{</span><span class="n">current_trendline</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-0-24"><a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="k">end</span>
</span></code></pre></div>
<h3 id="practical-application">Practical Application<a class="headerlink" href="#practical-application" title="Permanent link">&para;</a></h3>
<div class="language-ruby highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="c1"># Use trendline for trend following and crossover signals</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="n">trendline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SQA</span><span class="o">::</span><span class="no">TAI</span><span class="o">.</span><span class="n">ht_trendline</span><span class="p">(</span><span class="n">prices</span><span class="p">)</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="c1"># Detect crossovers</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="k">if</span><span class="w"> </span><span class="n">prices</span><span class="o">.</span><span class="n">size</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">trendline</span><span class="o">.</span><span class="n">size</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">2</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="w">  </span><span class="n">prev_price</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">prices</span><span class="o">[-</span><span class="mi">2</span><span class="o">]</span>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="w">  </span><span class="n">prev_trendline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">trendline</span><span class="o">[-</span><span class="mi">2</span><span class="o">]</span>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="w">  </span><span class="n">current_price</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">prices</span><span class="o">.</span><span class="n">last</span>
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a><span class="w">  </span><span class="n">current_trendline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">trendline</span><span class="o">.</span><span class="n">last</span>
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a>
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a><span class="w">  </span><span class="c1"># Bullish crossover: price crosses above trendline</span>
</span><span id="__span-1-13"><a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="n">prev_price</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">prev_trendline</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">current_price</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">current_trendline</span>
</span><span id="__span-1-14"><a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;BULLISH CROSSOVER: Buy signal&quot;</span>
</span><span id="__span-1-15"><a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Price crossed above adaptive trendline&quot;</span>
</span><span id="__span-1-16"><a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a>
</span><span id="__span-1-17"><a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a><span class="w">  </span><span class="c1"># Bearish crossover: price crosses below trendline</span>
</span><span id="__span-1-18"><a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a><span class="w">  </span><span class="k">elsif</span><span class="w"> </span><span class="n">prev_price</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">prev_trendline</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">current_price</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">current_trendline</span>
</span><span id="__span-1-19"><a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;BEARISH CROSSOVER: Sell signal&quot;</span>
</span><span id="__span-1-20"><a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Price crossed below adaptive trendline&quot;</span>
</span><span id="__span-1-21"><a id="__codelineno-1-21" name="__codelineno-1-21" href="#__codelineno-1-21"></a><span class="w">  </span><span class="k">end</span>
</span><span id="__span-1-22"><a id="__codelineno-1-22" name="__codelineno-1-22" href="#__codelineno-1-22"></a><span class="k">end</span>
</span></code></pre></div>
<h2 id="understanding-the-indicator">Understanding the Indicator<a class="headerlink" href="#understanding-the-indicator" title="Permanent link">&para;</a></h2>
<h3 id="what-it-measures">What It Measures<a class="headerlink" href="#what-it-measures" title="Permanent link">&para;</a></h3>
<p>HT_TRENDLINE calculates an <strong>adaptive trendline</strong> that automatically adjusts its smoothing based on the current dominant market cycle. The trendline acts as a dynamic support/resistance level and trend direction indicator that:</p>
<ul>
<li>Follows trends with minimal lag</li>
<li>Adapts to changing market cycle lengths</li>
<li>Provides smoother trendline during longer cycles</li>
<li>Becomes more responsive during shorter cycles</li>
<li>Eliminates the need to manually adjust moving average periods</li>
</ul>
<p>The indicator answers the question: "Where is the current trend center based on the market's natural rhythm?"</p>
<h3 id="why-its-important">Why It's Important<a class="headerlink" href="#why-its-important" title="Permanent link">&para;</a></h3>
<p>Traditional moving averages have a fundamental limitation: their fixed period may not match current market conditions:</p>
<p><strong>Problems with Fixed-Period MAs:</strong>
- 20-period MA too slow during fast cycles (creates excessive lag)
- 20-period MA too fast during slow cycles (generates false signals)
- Constant parameter optimization required as market conditions change
- Same period doesn't work well across different market regimes</p>
<p><strong>HT_TRENDLINE Solutions:</strong>
- Automatically adapts to current cycle length (no optimization needed)
- Reduces lag compared to traditional MAs of similar smoothness
- Maintains effectiveness as market conditions change
- Single indicator works across different market regimes
- More reliable support/resistance levels</p>
<p>By adapting to the market's natural cycle, HT_TRENDLINE provides a trendline that "fits" current conditions without manual adjustment.</p>
<h3 id="calculation-method">Calculation Method<a class="headerlink" href="#calculation-method" title="Permanent link">&para;</a></h3>
<p>The Hilbert Transform uses digital signal processing to create an adaptive trendline:</p>
<ol>
<li><strong>Detect Dominant Cycle</strong>: Apply Hilbert Transform to identify the current market cycle period</li>
<li><strong>Calculate Phase</strong>: Determine the instantaneous phase of the price cycle</li>
<li><strong>Adaptive Smoothing</strong>: Apply smoothing that adapts to the detected cycle length</li>
<li><strong>Generate Trendline</strong>: Produce an instantaneous trendline value that adjusts to cycle changes</li>
<li><strong>Output</strong>: Return adaptive trendline values that minimize lag while maintaining smoothness</li>
</ol>
<p><strong>Key Concept:</strong>
Think of it like a ship's autopilot that constantly adjusts to changing sea conditions. When waves (cycles) are short and choppy, it responds quickly. When waves are long and rolling, it makes smoother adjustments. The trendline automatically "knows" what kind of market cycle it's in and adjusts accordingly.</p>
<h3 id="indicator-characteristics">Indicator Characteristics<a class="headerlink" href="#indicator-characteristics" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Range</strong>: Follows price, no fixed range</li>
<li><strong>Type</strong>: Adaptive trend-following indicator, dynamic support/resistance</li>
<li><strong>Lag</strong>: Lower lag than fixed-period MAs of comparable smoothness</li>
<li><strong>Best Used</strong>: Trend identification, crossover signals, support/resistance</li>
<li><strong>Adaptation</strong>: Automatically adjusts to market cycle changes</li>
</ul>
<h2 id="interpretation">Interpretation<a class="headerlink" href="#interpretation" title="Permanent link">&para;</a></h2>
<h3 id="price-position-relative-to-trendline">Price Position Relative to Trendline<a class="headerlink" href="#price-position-relative-to-trendline" title="Permanent link">&para;</a></h3>
<p><strong>Price Above Trendline (Bullish)</strong></p>
<p>Market characteristics:
- Current uptrend in effect
- Trendline acts as dynamic support
- Buyers in control
- Higher probability of continued upward movement
- Pullbacks to trendline often provide buying opportunities</p>
<p><strong>What to do:</strong>
- Look for long opportunities
- Use trendline as support level for stop placement
- Buy pullbacks to trendline
- Hold long positions while price remains above trendline
- Avoid short positions</p>
<p><strong>Price Below Trendline (Bearish)</strong></p>
<p>Market characteristics:
- Current downtrend in effect
- Trendline acts as dynamic resistance
- Sellers in control
- Higher probability of continued downward movement
- Rallies to trendline often provide selling opportunities</p>
<p><strong>What to do:</strong>
- Look for short opportunities
- Use trendline as resistance level for stop placement
- Sell rallies to trendline
- Hold short positions while price remains below trendline
- Avoid long positions</p>
<h3 id="crossover-signals">Crossover Signals<a class="headerlink" href="#crossover-signals" title="Permanent link">&para;</a></h3>
<p><strong>Bullish Crossover (Price crosses above trendline)</strong></p>
<ul>
<li>Potential trend change from down to up</li>
<li>Buy signal</li>
<li>Entry point for long positions</li>
<li>Place stop loss below recent swing low</li>
<li>Trendline becomes support going forward</li>
</ul>
<p><strong>Bearish Crossover (Price crosses below trendline)</strong></p>
<ul>
<li>Potential trend change from up to down</li>
<li>Sell signal</li>
<li>Exit point for long positions or short entry</li>
<li>Place stop loss above recent swing high</li>
<li>Trendline becomes resistance going forward</li>
</ul>
<h3 id="trendline-slope-and-distance">Trendline Slope and Distance<a class="headerlink" href="#trendline-slope-and-distance" title="Permanent link">&para;</a></h3>
<p><strong>Steep Slope:</strong>
- Strong trend
- Rapid price movement
- Higher volatility
- Larger profit potential but also higher risk</p>
<p><strong>Gentle Slope:</strong>
- Moderate trend
- Steady price movement
- Lower volatility
- More sustainable trend</p>
<p><strong>Price Far from Trendline:</strong>
- Overextended move
- Potential for pullback to trendline
- Profit-taking opportunity if already in position
- Wait for better entry if considering new position</p>
<p><strong>Price Near Trendline:</strong>
- Healthy trend with normal pullback
- Good entry opportunity in direction of trend
- Trendline testing support/resistance</p>
<h2 id="trading-signals">Trading Signals<a class="headerlink" href="#trading-signals" title="Permanent link">&para;</a></h2>
<h3 id="crossover-trading-strategy">Crossover Trading Strategy<a class="headerlink" href="#crossover-trading-strategy" title="Permanent link">&para;</a></h3>
<p><strong>Primary Use Case:</strong> Trend change and continuation signals</p>
<div class="language-ruby highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="c1"># Calculate adaptive trendline</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="n">trendline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SQA</span><span class="o">::</span><span class="no">TAI</span><span class="o">.</span><span class="n">ht_trendline</span><span class="p">(</span><span class="n">prices</span><span class="p">)</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="c1"># Track current and previous positions</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="n">current_price</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">prices</span><span class="o">.</span><span class="n">last</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="n">prev_price</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">prices</span><span class="o">[-</span><span class="mi">2</span><span class="o">]</span>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="n">current_trendline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">trendline</span><span class="o">.</span><span class="n">last</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="n">prev_trendline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">trendline</span><span class="o">[-</span><span class="mi">2</span><span class="o">]</span>
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a>
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a><span class="c1"># Calculate ATR for stops and targets</span>
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a><span class="n">atr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SQA</span><span class="o">::</span><span class="no">TAI</span><span class="o">.</span><span class="n">atr</span><span class="p">(</span><span class="n">highs</span><span class="p">,</span><span class="w"> </span><span class="n">lows</span><span class="p">,</span><span class="w"> </span><span class="n">prices</span><span class="p">,</span><span class="w"> </span><span class="ss">period</span><span class="p">:</span><span class="w"> </span><span class="mi">14</span><span class="p">)</span>
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a><span class="n">current_atr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">atr</span><span class="o">.</span><span class="n">last</span>
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a>
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a><span class="c1"># Detect crossovers</span>
</span><span id="__span-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a><span class="n">bullish_cross</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">prev_price</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">prev_trendline</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">current_price</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">current_trendline</span>
</span><span id="__span-2-16"><a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a><span class="n">bearish_cross</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">prev_price</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">prev_trendline</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">current_price</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">current_trendline</span>
</span><span id="__span-2-17"><a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a>
</span><span id="__span-2-18"><a id="__codelineno-2-18" name="__codelineno-2-18" href="#__codelineno-2-18"></a><span class="k">if</span><span class="w"> </span><span class="n">bullish_cross</span>
</span><span id="__span-2-19"><a id="__codelineno-2-19" name="__codelineno-2-19" href="#__codelineno-2-19"></a><span class="w">  </span><span class="n">entry</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">current_price</span>
</span><span id="__span-2-20"><a id="__codelineno-2-20" name="__codelineno-2-20" href="#__codelineno-2-20"></a><span class="w">  </span><span class="n">stop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">entry</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="o">.</span><span class="mi">0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">current_atr</span><span class="p">)</span>
</span><span id="__span-2-21"><a id="__codelineno-2-21" name="__codelineno-2-21" href="#__codelineno-2-21"></a><span class="w">  </span><span class="n">target</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">entry</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="o">.</span><span class="mi">0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">current_atr</span><span class="p">)</span>
</span><span id="__span-2-22"><a id="__codelineno-2-22" name="__codelineno-2-22" href="#__codelineno-2-22"></a>
</span><span id="__span-2-23"><a id="__codelineno-2-23" name="__codelineno-2-23" href="#__codelineno-2-23"></a><span class="w">  </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;BULLISH CROSSOVER SIGNAL&quot;</span>
</span><span id="__span-2-24"><a id="__codelineno-2-24" name="__codelineno-2-24" href="#__codelineno-2-24"></a><span class="w">  </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Entry: BUY at </span><span class="si">#{</span><span class="n">entry</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-2-25"><a id="__codelineno-2-25" name="__codelineno-2-25" href="#__codelineno-2-25"></a><span class="w">  </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Stop Loss: </span><span class="si">#{</span><span class="n">stop</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2"> (below trendline)&quot;</span>
</span><span id="__span-2-26"><a id="__codelineno-2-26" name="__codelineno-2-26" href="#__codelineno-2-26"></a><span class="w">  </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Take Profit: </span><span class="si">#{</span><span class="n">target</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2"> (3:1 R/R)&quot;</span>
</span><span id="__span-2-27"><a id="__codelineno-2-27" name="__codelineno-2-27" href="#__codelineno-2-27"></a><span class="w">  </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Trendline: </span><span class="si">#{</span><span class="n">current_trendline</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2"> (now support)&quot;</span>
</span><span id="__span-2-28"><a id="__codelineno-2-28" name="__codelineno-2-28" href="#__codelineno-2-28"></a>
</span><span id="__span-2-29"><a id="__codelineno-2-29" name="__codelineno-2-29" href="#__codelineno-2-29"></a><span class="k">elsif</span><span class="w"> </span><span class="n">bearish_cross</span>
</span><span id="__span-2-30"><a id="__codelineno-2-30" name="__codelineno-2-30" href="#__codelineno-2-30"></a><span class="w">  </span><span class="n">entry</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">current_price</span>
</span><span id="__span-2-31"><a id="__codelineno-2-31" name="__codelineno-2-31" href="#__codelineno-2-31"></a><span class="w">  </span><span class="n">stop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">entry</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="o">.</span><span class="mi">0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">current_atr</span><span class="p">)</span>
</span><span id="__span-2-32"><a id="__codelineno-2-32" name="__codelineno-2-32" href="#__codelineno-2-32"></a><span class="w">  </span><span class="n">target</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">entry</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="o">.</span><span class="mi">0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">current_atr</span><span class="p">)</span>
</span><span id="__span-2-33"><a id="__codelineno-2-33" name="__codelineno-2-33" href="#__codelineno-2-33"></a>
</span><span id="__span-2-34"><a id="__codelineno-2-34" name="__codelineno-2-34" href="#__codelineno-2-34"></a><span class="w">  </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;BEARISH CROSSOVER SIGNAL&quot;</span>
</span><span id="__span-2-35"><a id="__codelineno-2-35" name="__codelineno-2-35" href="#__codelineno-2-35"></a><span class="w">  </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Entry: SELL at </span><span class="si">#{</span><span class="n">entry</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-2-36"><a id="__codelineno-2-36" name="__codelineno-2-36" href="#__codelineno-2-36"></a><span class="w">  </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Stop Loss: </span><span class="si">#{</span><span class="n">stop</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2"> (above trendline)&quot;</span>
</span><span id="__span-2-37"><a id="__codelineno-2-37" name="__codelineno-2-37" href="#__codelineno-2-37"></a><span class="w">  </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Take Profit: </span><span class="si">#{</span><span class="n">target</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2"> (3:1 R/R)&quot;</span>
</span><span id="__span-2-38"><a id="__codelineno-2-38" name="__codelineno-2-38" href="#__codelineno-2-38"></a><span class="w">  </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Trendline: </span><span class="si">#{</span><span class="n">current_trendline</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2"> (now resistance)&quot;</span>
</span><span id="__span-2-39"><a id="__codelineno-2-39" name="__codelineno-2-39" href="#__codelineno-2-39"></a><span class="k">end</span>
</span></code></pre></div>
<h3 id="trend-following-with-pullbacks">Trend Following with Pullbacks<a class="headerlink" href="#trend-following-with-pullbacks" title="Permanent link">&para;</a></h3>
<p><strong>Use Case:</strong> Enter on pullbacks to trendline in established trend</p>
<div class="language-ruby highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="n">trendline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SQA</span><span class="o">::</span><span class="no">TAI</span><span class="o">.</span><span class="n">ht_trendline</span><span class="p">(</span><span class="n">prices</span><span class="p">)</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="n">atr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SQA</span><span class="o">::</span><span class="no">TAI</span><span class="o">.</span><span class="n">atr</span><span class="p">(</span><span class="n">highs</span><span class="p">,</span><span class="w"> </span><span class="n">lows</span><span class="p">,</span><span class="w"> </span><span class="n">prices</span><span class="p">,</span><span class="w"> </span><span class="ss">period</span><span class="p">:</span><span class="w"> </span><span class="mi">14</span><span class="p">)</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="n">current_price</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">prices</span><span class="o">.</span><span class="n">last</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="n">current_trendline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">trendline</span><span class="o">.</span><span class="n">last</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="n">current_atr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">atr</span><span class="o">.</span><span class="n">last</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="n">low_price</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lows</span><span class="o">.</span><span class="n">last</span>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="n">high_price</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">highs</span><span class="o">.</span><span class="n">last</span>
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a>
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a><span class="c1"># Define pullback as price touching or approaching trendline</span>
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a><span class="n">pullback_threshold</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">current_atr</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">0</span><span class="o">.</span><span class="mi">5</span>
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a>
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a><span class="c1"># UPTREND: Buy pullbacks to trendline</span>
</span><span id="__span-3-14"><a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a><span class="k">if</span><span class="w"> </span><span class="n">current_price</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">current_trendline</span>
</span><span id="__span-3-15"><a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a><span class="w">  </span><span class="n">distance_to_trendline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">low_price</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">current_trendline</span>
</span><span id="__span-3-16"><a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a>
</span><span id="__span-3-17"><a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="n">distance_to_trendline</span><span class="o">.</span><span class="n">abs</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">pullback_threshold</span>
</span><span id="__span-3-18"><a id="__codelineno-3-18" name="__codelineno-3-18" href="#__codelineno-3-18"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;UPTREND PULLBACK BUY OPPORTUNITY&quot;</span>
</span><span id="__span-3-19"><a id="__codelineno-3-19" name="__codelineno-3-19" href="#__codelineno-3-19"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Price testing trendline support at </span><span class="si">#{</span><span class="n">current_trendline</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-3-20"><a id="__codelineno-3-20" name="__codelineno-3-20" href="#__codelineno-3-20"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Current price: </span><span class="si">#{</span><span class="n">current_price</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-3-21"><a id="__codelineno-3-21" name="__codelineno-3-21" href="#__codelineno-3-21"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Buy near: </span><span class="si">#{</span><span class="n">current_trendline</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-3-22"><a id="__codelineno-3-22" name="__codelineno-3-22" href="#__codelineno-3-22"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Stop: </span><span class="si">#{</span><span class="p">(</span><span class="n">current_trendline</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">current_atr</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-3-23"><a id="__codelineno-3-23" name="__codelineno-3-23" href="#__codelineno-3-23"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Target: </span><span class="si">#{</span><span class="p">(</span><span class="n">current_price</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">current_atr</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-3-24"><a id="__codelineno-3-24" name="__codelineno-3-24" href="#__codelineno-3-24"></a><span class="w">  </span><span class="k">end</span>
</span><span id="__span-3-25"><a id="__codelineno-3-25" name="__codelineno-3-25" href="#__codelineno-3-25"></a>
</span><span id="__span-3-26"><a id="__codelineno-3-26" name="__codelineno-3-26" href="#__codelineno-3-26"></a><span class="c1"># DOWNTREND: Sell rallies to trendline</span>
</span><span id="__span-3-27"><a id="__codelineno-3-27" name="__codelineno-3-27" href="#__codelineno-3-27"></a><span class="k">elsif</span><span class="w"> </span><span class="n">current_price</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">current_trendline</span>
</span><span id="__span-3-28"><a id="__codelineno-3-28" name="__codelineno-3-28" href="#__codelineno-3-28"></a><span class="w">  </span><span class="n">distance_to_trendline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">high_price</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">current_trendline</span>
</span><span id="__span-3-29"><a id="__codelineno-3-29" name="__codelineno-3-29" href="#__codelineno-3-29"></a>
</span><span id="__span-3-30"><a id="__codelineno-3-30" name="__codelineno-3-30" href="#__codelineno-3-30"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="n">distance_to_trendline</span><span class="o">.</span><span class="n">abs</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">pullback_threshold</span>
</span><span id="__span-3-31"><a id="__codelineno-3-31" name="__codelineno-3-31" href="#__codelineno-3-31"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;DOWNTREND RALLY SELL OPPORTUNITY&quot;</span>
</span><span id="__span-3-32"><a id="__codelineno-3-32" name="__codelineno-3-32" href="#__codelineno-3-32"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Price testing trendline resistance at </span><span class="si">#{</span><span class="n">current_trendline</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-3-33"><a id="__codelineno-3-33" name="__codelineno-3-33" href="#__codelineno-3-33"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Current price: </span><span class="si">#{</span><span class="n">current_price</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-3-34"><a id="__codelineno-3-34" name="__codelineno-3-34" href="#__codelineno-3-34"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Sell near: </span><span class="si">#{</span><span class="n">current_trendline</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-3-35"><a id="__codelineno-3-35" name="__codelineno-3-35" href="#__codelineno-3-35"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Stop: </span><span class="si">#{</span><span class="p">(</span><span class="n">current_trendline</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">current_atr</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-3-36"><a id="__codelineno-3-36" name="__codelineno-3-36" href="#__codelineno-3-36"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Target: </span><span class="si">#{</span><span class="p">(</span><span class="n">current_price</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">current_atr</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-3-37"><a id="__codelineno-3-37" name="__codelineno-3-37" href="#__codelineno-3-37"></a><span class="w">  </span><span class="k">end</span>
</span><span id="__span-3-38"><a id="__codelineno-3-38" name="__codelineno-3-38" href="#__codelineno-3-38"></a><span class="k">end</span>
</span></code></pre></div>
<h3 id="dynamic-stop-loss-management">Dynamic Stop Loss Management<a class="headerlink" href="#dynamic-stop-loss-management" title="Permanent link">&para;</a></h3>
<p><strong>Use Case:</strong> Trail stops using adaptive trendline</p>
<div class="language-ruby highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="c1"># Position management example</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="n">trendline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SQA</span><span class="o">::</span><span class="no">TAI</span><span class="o">.</span><span class="n">ht_trendline</span><span class="p">(</span><span class="n">prices</span><span class="p">)</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="n">atr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SQA</span><span class="o">::</span><span class="no">TAI</span><span class="o">.</span><span class="n">atr</span><span class="p">(</span><span class="n">highs</span><span class="p">,</span><span class="w"> </span><span class="n">lows</span><span class="p">,</span><span class="w"> </span><span class="n">prices</span><span class="p">,</span><span class="w"> </span><span class="ss">period</span><span class="p">:</span><span class="w"> </span><span class="mi">14</span><span class="p">)</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="n">current_price</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">prices</span><span class="o">.</span><span class="n">last</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="n">current_trendline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">trendline</span><span class="o">.</span><span class="n">last</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="n">current_atr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">atr</span><span class="o">.</span><span class="n">last</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a><span class="c1"># Assume we have a long position</span>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a><span class="n">entry_price</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">45</span><span class="o">.</span><span class="mi">50</span><span class="w">  </span><span class="c1"># example entry</span>
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a><span class="n">position_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">:long</span>
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a>
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a><span class="k">if</span><span class="w"> </span><span class="n">position_type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="ss">:long</span>
</span><span id="__span-4-14"><a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a><span class="w">  </span><span class="c1"># Trail stop below trendline</span>
</span><span id="__span-4-15"><a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a><span class="w">  </span><span class="n">trailing_stop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">current_trendline</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="o">.</span><span class="mi">0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">current_atr</span><span class="p">)</span>
</span><span id="__span-4-16"><a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a>
</span><span id="__span-4-17"><a id="__codelineno-4-17" name="__codelineno-4-17" href="#__codelineno-4-17"></a><span class="w">  </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;LONG POSITION MANAGEMENT&quot;</span>
</span><span id="__span-4-18"><a id="__codelineno-4-18" name="__codelineno-4-18" href="#__codelineno-4-18"></a><span class="w">  </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Entry: </span><span class="si">#{</span><span class="n">entry_price</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-4-19"><a id="__codelineno-4-19" name="__codelineno-4-19" href="#__codelineno-4-19"></a><span class="w">  </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Current Price: </span><span class="si">#{</span><span class="n">current_price</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-4-20"><a id="__codelineno-4-20" name="__codelineno-4-20" href="#__codelineno-4-20"></a><span class="w">  </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Trendline: </span><span class="si">#{</span><span class="n">current_trendline</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-4-21"><a id="__codelineno-4-21" name="__codelineno-4-21" href="#__codelineno-4-21"></a><span class="w">  </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Trailing Stop: </span><span class="si">#{</span><span class="n">trailing_stop</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-4-22"><a id="__codelineno-4-22" name="__codelineno-4-22" href="#__codelineno-4-22"></a><span class="w">  </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;P/L: </span><span class="si">#{</span><span class="p">((</span><span class="n">current_price</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">entry_price</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">entry_price</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">%&quot;</span>
</span><span id="__span-4-23"><a id="__codelineno-4-23" name="__codelineno-4-23" href="#__codelineno-4-23"></a>
</span><span id="__span-4-24"><a id="__codelineno-4-24" name="__codelineno-4-24" href="#__codelineno-4-24"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="n">current_price</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">trailing_stop</span>
</span><span id="__span-4-25"><a id="__codelineno-4-25" name="__codelineno-4-25" href="#__codelineno-4-25"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;STOP HIT - Exit long position&quot;</span>
</span><span id="__span-4-26"><a id="__codelineno-4-26" name="__codelineno-4-26" href="#__codelineno-4-26"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Price broke below trendline support&quot;</span>
</span><span id="__span-4-27"><a id="__codelineno-4-27" name="__codelineno-4-27" href="#__codelineno-4-27"></a><span class="w">  </span><span class="k">elsif</span><span class="w"> </span><span class="n">current_price</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">current_trendline</span>
</span><span id="__span-4-28"><a id="__codelineno-4-28" name="__codelineno-4-28" href="#__codelineno-4-28"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;WARNING - Price below trendline (potential trend change)&quot;</span>
</span><span id="__span-4-29"><a id="__codelineno-4-29" name="__codelineno-4-29" href="#__codelineno-4-29"></a><span class="w">  </span><span class="k">else</span>
</span><span id="__span-4-30"><a id="__codelineno-4-30" name="__codelineno-4-30" href="#__codelineno-4-30"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;HOLD - Price above trendline, trend intact&quot;</span>
</span><span id="__span-4-31"><a id="__codelineno-4-31" name="__codelineno-4-31" href="#__codelineno-4-31"></a><span class="w">  </span><span class="k">end</span>
</span><span id="__span-4-32"><a id="__codelineno-4-32" name="__codelineno-4-32" href="#__codelineno-4-32"></a>
</span><span id="__span-4-33"><a id="__codelineno-4-33" name="__codelineno-4-33" href="#__codelineno-4-33"></a><span class="k">else</span><span class="w">  </span><span class="c1"># short position</span>
</span><span id="__span-4-34"><a id="__codelineno-4-34" name="__codelineno-4-34" href="#__codelineno-4-34"></a><span class="w">  </span><span class="c1"># Trail stop above trendline</span>
</span><span id="__span-4-35"><a id="__codelineno-4-35" name="__codelineno-4-35" href="#__codelineno-4-35"></a><span class="w">  </span><span class="n">trailing_stop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">current_trendline</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="o">.</span><span class="mi">0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">current_atr</span><span class="p">)</span>
</span><span id="__span-4-36"><a id="__codelineno-4-36" name="__codelineno-4-36" href="#__codelineno-4-36"></a>
</span><span id="__span-4-37"><a id="__codelineno-4-37" name="__codelineno-4-37" href="#__codelineno-4-37"></a><span class="w">  </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;SHORT POSITION MANAGEMENT&quot;</span>
</span><span id="__span-4-38"><a id="__codelineno-4-38" name="__codelineno-4-38" href="#__codelineno-4-38"></a><span class="w">  </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Entry: </span><span class="si">#{</span><span class="n">entry_price</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-4-39"><a id="__codelineno-4-39" name="__codelineno-4-39" href="#__codelineno-4-39"></a><span class="w">  </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Current Price: </span><span class="si">#{</span><span class="n">current_price</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-4-40"><a id="__codelineno-4-40" name="__codelineno-4-40" href="#__codelineno-4-40"></a><span class="w">  </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Trendline: </span><span class="si">#{</span><span class="n">current_trendline</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-4-41"><a id="__codelineno-4-41" name="__codelineno-4-41" href="#__codelineno-4-41"></a><span class="w">  </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Trailing Stop: </span><span class="si">#{</span><span class="n">trailing_stop</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-4-42"><a id="__codelineno-4-42" name="__codelineno-4-42" href="#__codelineno-4-42"></a><span class="w">  </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;P/L: </span><span class="si">#{</span><span class="p">((</span><span class="n">entry_price</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">current_price</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">entry_price</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">%&quot;</span>
</span><span id="__span-4-43"><a id="__codelineno-4-43" name="__codelineno-4-43" href="#__codelineno-4-43"></a>
</span><span id="__span-4-44"><a id="__codelineno-4-44" name="__codelineno-4-44" href="#__codelineno-4-44"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="n">current_price</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">trailing_stop</span>
</span><span id="__span-4-45"><a id="__codelineno-4-45" name="__codelineno-4-45" href="#__codelineno-4-45"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;STOP HIT - Exit short position&quot;</span>
</span><span id="__span-4-46"><a id="__codelineno-4-46" name="__codelineno-4-46" href="#__codelineno-4-46"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Price broke above trendline resistance&quot;</span>
</span><span id="__span-4-47"><a id="__codelineno-4-47" name="__codelineno-4-47" href="#__codelineno-4-47"></a><span class="w">  </span><span class="k">elsif</span><span class="w"> </span><span class="n">current_price</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">current_trendline</span>
</span><span id="__span-4-48"><a id="__codelineno-4-48" name="__codelineno-4-48" href="#__codelineno-4-48"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;WARNING - Price above trendline (potential trend change)&quot;</span>
</span><span id="__span-4-49"><a id="__codelineno-4-49" name="__codelineno-4-49" href="#__codelineno-4-49"></a><span class="w">  </span><span class="k">else</span>
</span><span id="__span-4-50"><a id="__codelineno-4-50" name="__codelineno-4-50" href="#__codelineno-4-50"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;HOLD - Price below trendline, downtrend intact&quot;</span>
</span><span id="__span-4-51"><a id="__codelineno-4-51" name="__codelineno-4-51" href="#__codelineno-4-51"></a><span class="w">  </span><span class="k">end</span>
</span><span id="__span-4-52"><a id="__codelineno-4-52" name="__codelineno-4-52" href="#__codelineno-4-52"></a><span class="k">end</span>
</span></code></pre></div>
<h2 id="best-practices">Best Practices<a class="headerlink" href="#best-practices" title="Permanent link">&para;</a></h2>
<h3 id="optimal-use-cases">Optimal Use Cases<a class="headerlink" href="#optimal-use-cases" title="Permanent link">&para;</a></h3>
<p><strong>When HT_TRENDLINE works best:</strong>
- <strong>Trend following</strong>: Primary use - identifying and following trends
- <strong>Trending markets</strong>: More effective when clear trends exist
- <strong>Medium to long-term trading</strong>: Daily to weekly charts
- <strong>Dynamic support/resistance</strong>: Adaptive levels that adjust to market conditions
- <strong>All asset classes</strong>: Stocks, forex, commodities, crypto
- <strong>Crossover systems</strong>: Less whipsaw than fixed-period MA crossovers</p>
<p><strong>Less effective in:</strong>
- Strongly ranging/sideways markets (use HT_TRENDMODE to detect)
- Very short timeframes (&lt; 15 minute charts) - too much noise
- Low-liquidity markets with erratic price movements
- During major news events with sudden volatility spikes</p>
<h3 id="combining-with-other-indicators">Combining with Other Indicators<a class="headerlink" href="#combining-with-other-indicators" title="Permanent link">&para;</a></h3>
<p><strong>With HT_TRENDMODE:</strong>
<div class="language-ruby highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="c1"># Use HT_TRENDMODE to filter when to use trendline</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="n">mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SQA</span><span class="o">::</span><span class="no">TAI</span><span class="o">.</span><span class="n">ht_trendmode</span><span class="p">(</span><span class="n">prices</span><span class="p">)</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="n">trendline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SQA</span><span class="o">::</span><span class="no">TAI</span><span class="o">.</span><span class="n">ht_trendline</span><span class="p">(</span><span class="n">prices</span><span class="p">)</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="n">current_mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mode</span><span class="o">.</span><span class="n">last</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="n">current_price</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">prices</span><span class="o">.</span><span class="n">last</span>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="n">current_trendline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">trendline</span><span class="o">.</span><span class="n">last</span>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a>
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a><span class="k">if</span><span class="w"> </span><span class="n">current_mode</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span>
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a><span class="w">  </span><span class="c1"># TREND MODE: Trust trendline signals</span>
</span><span id="__span-5-11"><a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a><span class="w">  </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Market in TREND MODE - HT_TRENDLINE reliable&quot;</span>
</span><span id="__span-5-12"><a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a>
</span><span id="__span-5-13"><a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="n">current_price</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">current_trendline</span>
</span><span id="__span-5-14"><a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Uptrend confirmed - follow long signals&quot;</span>
</span><span id="__span-5-15"><a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a><span class="w">  </span><span class="k">else</span>
</span><span id="__span-5-16"><a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Downtrend confirmed - follow short signals&quot;</span>
</span><span id="__span-5-17"><a id="__codelineno-5-17" name="__codelineno-5-17" href="#__codelineno-5-17"></a><span class="w">  </span><span class="k">end</span>
</span><span id="__span-5-18"><a id="__codelineno-5-18" name="__codelineno-5-18" href="#__codelineno-5-18"></a>
</span><span id="__span-5-19"><a id="__codelineno-5-19" name="__codelineno-5-19" href="#__codelineno-5-19"></a><span class="k">else</span>
</span><span id="__span-5-20"><a id="__codelineno-5-20" name="__codelineno-5-20" href="#__codelineno-5-20"></a><span class="w">  </span><span class="c1"># CYCLE MODE: Trendline less reliable, use oscillators instead</span>
</span><span id="__span-5-21"><a id="__codelineno-5-21" name="__codelineno-5-21" href="#__codelineno-5-21"></a><span class="w">  </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Market in CYCLE MODE - HT_TRENDLINE may whipsaw&quot;</span>
</span><span id="__span-5-22"><a id="__codelineno-5-22" name="__codelineno-5-22" href="#__codelineno-5-22"></a><span class="w">  </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Consider using oscillators (RSI, Stochastic) for mean-reversion instead&quot;</span>
</span><span id="__span-5-23"><a id="__codelineno-5-23" name="__codelineno-5-23" href="#__codelineno-5-23"></a><span class="k">end</span>
</span></code></pre></div></p>
<p><strong>With HT_DCPERIOD:</strong>
<div class="language-ruby highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="c1"># Compare adaptive trendline to cycle-optimized moving average</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="n">trendline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SQA</span><span class="o">::</span><span class="no">TAI</span><span class="o">.</span><span class="n">ht_trendline</span><span class="p">(</span><span class="n">prices</span><span class="p">)</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="n">cycle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SQA</span><span class="o">::</span><span class="no">TAI</span><span class="o">.</span><span class="n">ht_dcperiod</span><span class="p">(</span><span class="n">prices</span><span class="p">)</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="n">current_cycle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cycle</span><span class="o">.</span><span class="n">last</span><span class="o">.</span><span class="n">round</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="n">current_trendline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">trendline</span><span class="o">.</span><span class="n">last</span>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="c1"># Create moving average based on detected cycle</span>
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="n">cycle_ma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SQA</span><span class="o">::</span><span class="no">TAI</span><span class="o">.</span><span class="n">sma</span><span class="p">(</span><span class="n">prices</span><span class="p">,</span><span class="w"> </span><span class="ss">period</span><span class="p">:</span><span class="w"> </span><span class="n">current_cycle</span><span class="p">)</span>
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a><span class="n">current_cycle_ma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cycle_ma</span><span class="o">.</span><span class="n">last</span>
</span><span id="__span-6-11"><a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a>
</span><span id="__span-6-12"><a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Adaptive Trendline: </span><span class="si">#{</span><span class="n">current_trendline</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-6-13"><a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">#{</span><span class="n">current_cycle</span><span class="si">}</span><span class="s2">-period SMA: </span><span class="si">#{</span><span class="n">current_cycle_ma</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-6-14"><a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Difference: </span><span class="si">#{</span><span class="p">(</span><span class="n">current_trendline</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">current_cycle_ma</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-6-15"><a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a>
</span><span id="__span-6-16"><a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a><span class="c1"># Both should be similar, confirming cycle-adaptive behavior</span>
</span></code></pre></div></p>
<p><strong>With Traditional Moving Averages:</strong>
<div class="language-ruby highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="c1"># Compare adaptive trendline to fixed-period MAs</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="n">trendline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SQA</span><span class="o">::</span><span class="no">TAI</span><span class="o">.</span><span class="n">ht_trendline</span><span class="p">(</span><span class="n">prices</span><span class="p">)</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="n">sma_20</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SQA</span><span class="o">::</span><span class="no">TAI</span><span class="o">.</span><span class="n">sma</span><span class="p">(</span><span class="n">prices</span><span class="p">,</span><span class="w"> </span><span class="ss">period</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="p">)</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="n">ema_20</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SQA</span><span class="o">::</span><span class="no">TAI</span><span class="o">.</span><span class="n">ema</span><span class="p">(</span><span class="n">prices</span><span class="p">,</span><span class="w"> </span><span class="ss">period</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="p">)</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="n">current_price</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">prices</span><span class="o">.</span><span class="n">last</span>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span class="n">current_trendline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">trendline</span><span class="o">.</span><span class="n">last</span>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a><span class="n">current_sma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sma_20</span><span class="o">.</span><span class="n">last</span>
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a><span class="n">current_ema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ema_20</span><span class="o">.</span><span class="n">last</span>
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a>
</span><span id="__span-7-11"><a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Current Price: </span><span class="si">#{</span><span class="n">current_price</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-7-12"><a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;HT Trendline: </span><span class="si">#{</span><span class="n">current_trendline</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2"> (adaptive)&quot;</span>
</span><span id="__span-7-13"><a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;SMA(20): </span><span class="si">#{</span><span class="n">current_sma</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2"> (fixed)&quot;</span>
</span><span id="__span-7-14"><a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;EMA(20): </span><span class="si">#{</span><span class="n">current_ema</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2"> (fixed)&quot;</span>
</span><span id="__span-7-15"><a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a><span class="nb">puts</span>
</span><span id="__span-7-16"><a id="__codelineno-7-16" name="__codelineno-7-16" href="#__codelineno-7-16"></a>
</span><span id="__span-7-17"><a id="__codelineno-7-17" name="__codelineno-7-17" href="#__codelineno-7-17"></a><span class="c1"># Adaptive trendline often shows less lag</span>
</span><span id="__span-7-18"><a id="__codelineno-7-18" name="__codelineno-7-18" href="#__codelineno-7-18"></a><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Trendline lag: </span><span class="si">#{</span><span class="p">(</span><span class="n">current_price</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">current_trendline</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-7-19"><a id="__codelineno-7-19" name="__codelineno-7-19" href="#__codelineno-7-19"></a><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;SMA lag: </span><span class="si">#{</span><span class="p">(</span><span class="n">current_price</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">current_sma</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-7-20"><a id="__codelineno-7-20" name="__codelineno-7-20" href="#__codelineno-7-20"></a><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;EMA lag: </span><span class="si">#{</span><span class="p">(</span><span class="n">current_price</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">current_ema</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span></code></pre></div></p>
<p><strong>With Volatility Indicators:</strong>
<div class="language-ruby highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="c1"># Use ATR for stop placement relative to trendline</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="n">trendline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SQA</span><span class="o">::</span><span class="no">TAI</span><span class="o">.</span><span class="n">ht_trendline</span><span class="p">(</span><span class="n">prices</span><span class="p">)</span>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="n">atr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SQA</span><span class="o">::</span><span class="no">TAI</span><span class="o">.</span><span class="n">atr</span><span class="p">(</span><span class="n">highs</span><span class="p">,</span><span class="w"> </span><span class="n">lows</span><span class="p">,</span><span class="w"> </span><span class="n">prices</span><span class="p">,</span><span class="w"> </span><span class="ss">period</span><span class="p">:</span><span class="w"> </span><span class="mi">14</span><span class="p">)</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="n">bb_upper</span><span class="p">,</span><span class="w"> </span><span class="n">bb_middle</span><span class="p">,</span><span class="w"> </span><span class="n">bb_lower</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SQA</span><span class="o">::</span><span class="no">TAI</span><span class="o">.</span><span class="n">bbands</span><span class="p">(</span><span class="n">prices</span><span class="p">,</span><span class="w"> </span><span class="ss">period</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="p">)</span>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="n">current_price</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">prices</span><span class="o">.</span><span class="n">last</span>
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="n">current_trendline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">trendline</span><span class="o">.</span><span class="n">last</span>
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="n">current_atr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">atr</span><span class="o">.</span><span class="n">last</span>
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a>
</span><span id="__span-8-10"><a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a><span class="c1"># Trendline with volatility-adjusted stops</span>
</span><span id="__span-8-11"><a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a><span class="k">if</span><span class="w"> </span><span class="n">current_price</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">current_trendline</span>
</span><span id="__span-8-12"><a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a><span class="w">  </span><span class="n">stop_loss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">current_trendline</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="o">.</span><span class="mi">5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">current_atr</span><span class="p">)</span>
</span><span id="__span-8-13"><a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a><span class="w">  </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;UPTREND: Trendline at </span><span class="si">#{</span><span class="n">current_trendline</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-8-14"><a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a><span class="w">  </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Stop Loss: </span><span class="si">#{</span><span class="n">stop_loss</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2"> (trendline - 1.5*ATR)&quot;</span>
</span><span id="__span-8-15"><a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a>
</span><span id="__span-8-16"><a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a><span class="w">  </span><span class="c1"># Check if price overextended using Bollinger Bands</span>
</span><span id="__span-8-17"><a id="__codelineno-8-17" name="__codelineno-8-17" href="#__codelineno-8-17"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="n">current_price</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">bb_upper</span><span class="o">.</span><span class="n">last</span>
</span><span id="__span-8-18"><a id="__codelineno-8-18" name="__codelineno-8-18" href="#__codelineno-8-18"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;WARNING: Price above upper BB - overextended&quot;</span>
</span><span id="__span-8-19"><a id="__codelineno-8-19" name="__codelineno-8-19" href="#__codelineno-8-19"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Consider waiting for pullback to trendline&quot;</span>
</span><span id="__span-8-20"><a id="__codelineno-8-20" name="__codelineno-8-20" href="#__codelineno-8-20"></a><span class="w">  </span><span class="k">end</span>
</span><span id="__span-8-21"><a id="__codelineno-8-21" name="__codelineno-8-21" href="#__codelineno-8-21"></a><span class="k">end</span>
</span></code></pre></div></p>
<p><strong>With Oscillators:</strong>
<div class="language-ruby highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="c1"># Use oscillators to time entries on pullbacks to trendline</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="n">trendline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SQA</span><span class="o">::</span><span class="no">TAI</span><span class="o">.</span><span class="n">ht_trendline</span><span class="p">(</span><span class="n">prices</span><span class="p">)</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="n">rsi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SQA</span><span class="o">::</span><span class="no">TAI</span><span class="o">.</span><span class="n">rsi</span><span class="p">(</span><span class="n">prices</span><span class="p">,</span><span class="w"> </span><span class="ss">period</span><span class="p">:</span><span class="w"> </span><span class="mi">14</span><span class="p">)</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="n">current_price</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">prices</span><span class="o">.</span><span class="n">last</span>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="n">current_trendline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">trendline</span><span class="o">.</span><span class="n">last</span>
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="n">current_rsi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rsi</span><span class="o">.</span><span class="n">last</span>
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a>
</span><span id="__span-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a><span class="c1"># UPTREND: Look for oversold RSI near trendline support</span>
</span><span id="__span-9-10"><a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a><span class="k">if</span><span class="w"> </span><span class="n">current_price</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">current_trendline</span>
</span><span id="__span-9-11"><a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a><span class="w">  </span><span class="n">distance_pct</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">((</span><span class="n">current_price</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">current_trendline</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">current_price</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span>
</span><span id="__span-9-12"><a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a>
</span><span id="__span-9-13"><a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="n">distance_pct</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">current_rsi</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">40</span>
</span><span id="__span-9-14"><a id="__codelineno-9-14" name="__codelineno-9-14" href="#__codelineno-9-14"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;STRONG BUY SETUP&quot;</span>
</span><span id="__span-9-15"><a id="__codelineno-9-15" name="__codelineno-9-15" href="#__codelineno-9-15"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Uptrend + Pullback to trendline + Oversold RSI&quot;</span>
</span><span id="__span-9-16"><a id="__codelineno-9-16" name="__codelineno-9-16" href="#__codelineno-9-16"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Price near trendline: </span><span class="si">#{</span><span class="n">current_trendline</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-9-17"><a id="__codelineno-9-17" name="__codelineno-9-17" href="#__codelineno-9-17"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;RSI: </span><span class="si">#{</span><span class="n">current_rsi</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-9-18"><a id="__codelineno-9-18" name="__codelineno-9-18" href="#__codelineno-9-18"></a><span class="w">  </span><span class="k">end</span>
</span><span id="__span-9-19"><a id="__codelineno-9-19" name="__codelineno-9-19" href="#__codelineno-9-19"></a>
</span><span id="__span-9-20"><a id="__codelineno-9-20" name="__codelineno-9-20" href="#__codelineno-9-20"></a><span class="c1"># DOWNTREND: Look for overbought RSI near trendline resistance</span>
</span><span id="__span-9-21"><a id="__codelineno-9-21" name="__codelineno-9-21" href="#__codelineno-9-21"></a><span class="k">elsif</span><span class="w"> </span><span class="n">current_price</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">current_trendline</span>
</span><span id="__span-9-22"><a id="__codelineno-9-22" name="__codelineno-9-22" href="#__codelineno-9-22"></a><span class="w">  </span><span class="n">distance_pct</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">((</span><span class="n">current_trendline</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">current_price</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">current_price</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span>
</span><span id="__span-9-23"><a id="__codelineno-9-23" name="__codelineno-9-23" href="#__codelineno-9-23"></a>
</span><span id="__span-9-24"><a id="__codelineno-9-24" name="__codelineno-9-24" href="#__codelineno-9-24"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="n">distance_pct</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">current_rsi</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">60</span>
</span><span id="__span-9-25"><a id="__codelineno-9-25" name="__codelineno-9-25" href="#__codelineno-9-25"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;STRONG SELL SETUP&quot;</span>
</span><span id="__span-9-26"><a id="__codelineno-9-26" name="__codelineno-9-26" href="#__codelineno-9-26"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Downtrend + Rally to trendline + Overbought RSI&quot;</span>
</span><span id="__span-9-27"><a id="__codelineno-9-27" name="__codelineno-9-27" href="#__codelineno-9-27"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Price near trendline: </span><span class="si">#{</span><span class="n">current_trendline</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-9-28"><a id="__codelineno-9-28" name="__codelineno-9-28" href="#__codelineno-9-28"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;RSI: </span><span class="si">#{</span><span class="n">current_rsi</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-9-29"><a id="__codelineno-9-29" name="__codelineno-9-29" href="#__codelineno-9-29"></a><span class="w">  </span><span class="k">end</span>
</span><span id="__span-9-30"><a id="__codelineno-9-30" name="__codelineno-9-30" href="#__codelineno-9-30"></a><span class="k">end</span>
</span></code></pre></div></p>
<h3 id="common-pitfalls">Common Pitfalls<a class="headerlink" href="#common-pitfalls" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>Insufficient Data</strong></li>
<li>Need minimum 32-63 bars for reliable trendline</li>
<li>Initial values will be unstable or incorrect</li>
<li>Always verify sufficient price history</li>
<li>
<p>Don't trade based on trendline with insufficient data</p>
</li>
<li>
<p><strong>Using in Ranging Markets</strong></p>
</li>
<li>Adaptive trendline still generates whipsaws in tight ranges</li>
<li>Check HT_TRENDMODE first (mode = 0 indicates ranging)</li>
<li>In cycle mode, switch to oscillators instead</li>
<li>
<p>Not all markets are suitable for trend-following</p>
</li>
<li>
<p><strong>Ignoring Volatility</strong></p>
</li>
<li>Trendline crossovers alone are insufficient</li>
<li>Always use ATR or volatility measure for stops</li>
<li>Wide stops in high volatility, tighter in low volatility</li>
<li>
<p>Distance from trendline should be volatility-adjusted</p>
</li>
<li>
<p><strong>Overtrading Crossovers</strong></p>
</li>
<li>Not every crossover is a high-quality signal</li>
<li>Require confirmation (volume, momentum, pattern)</li>
<li>Avoid trading against higher timeframe trend</li>
<li>
<p>Wait for clear separation after crossover</p>
</li>
<li>
<p><strong>Fixed Stop Distance</strong></p>
</li>
<li>Don't use fixed-point stops with adaptive trendline</li>
<li>Stops should adapt to current volatility (ATR-based)</li>
<li>Trail stops using trendline position</li>
<li>Adjust stop distance based on market conditions</li>
</ol>
<h3 id="strategy-guidelines">Strategy Guidelines<a class="headerlink" href="#strategy-guidelines" title="Permanent link">&para;</a></h3>
<p><strong>For Day Trading:</strong>
- Use HT_TRENDLINE on 15-minute to 1-hour charts
- Trendline adapts to intraday cycles
- Quick crossover signals for scalping and day trades
- Combine with volume for confirmation
- Use tight ATR-based stops</p>
<p><strong>For Swing Trading:</strong>
- Use HT_TRENDLINE on daily charts (most effective)
- Ideal timeframe for adaptive trendline
- Hold positions while price remains on correct side
- Trail stops below/above trendline
- Multi-day to multi-week holding periods</p>
<p><strong>For Position Trading:</strong>
- Use HT_TRENDLINE on weekly charts
- Long-term trend identification
- Major trend changes signaled by crossovers
- Wide stops to avoid premature exits
- Hold through normal volatility and pullbacks</p>
<h2 id="practical-example">Practical Example<a class="headerlink" href="#practical-example" title="Permanent link">&para;</a></h2>
<p>Complete trend-following system using adaptive trendline:</p>
<div class="language-ruby highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="nb">require</span><span class="w"> </span><span class="s1">&#39;sqa/tai&#39;</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="c1"># Historical price data (need at least 63 bars)</span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="n">prices</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="w">  </span><span class="c1"># ... your price data ...</span>
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a><span class="o">]</span>
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a><span class="n">highs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[...]</span>
</span><span id="__span-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a><span class="n">lows</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[...]</span>
</span><span id="__span-10-9"><a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a>
</span><span id="__span-10-10"><a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a><span class="c1"># Calculate adaptive trendline and supporting indicators</span>
</span><span id="__span-10-11"><a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a><span class="n">trendline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SQA</span><span class="o">::</span><span class="no">TAI</span><span class="o">.</span><span class="n">ht_trendline</span><span class="p">(</span><span class="n">prices</span><span class="p">)</span>
</span><span id="__span-10-12"><a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a><span class="n">mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SQA</span><span class="o">::</span><span class="no">TAI</span><span class="o">.</span><span class="n">ht_trendmode</span><span class="p">(</span><span class="n">prices</span><span class="p">)</span>
</span><span id="__span-10-13"><a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a><span class="n">cycle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SQA</span><span class="o">::</span><span class="no">TAI</span><span class="o">.</span><span class="n">ht_dcperiod</span><span class="p">(</span><span class="n">prices</span><span class="p">)</span>
</span><span id="__span-10-14"><a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a><span class="n">atr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SQA</span><span class="o">::</span><span class="no">TAI</span><span class="o">.</span><span class="n">atr</span><span class="p">(</span><span class="n">highs</span><span class="p">,</span><span class="w"> </span><span class="n">lows</span><span class="p">,</span><span class="w"> </span><span class="n">prices</span><span class="p">,</span><span class="w"> </span><span class="ss">period</span><span class="p">:</span><span class="w"> </span><span class="mi">14</span><span class="p">)</span>
</span><span id="__span-10-15"><a id="__codelineno-10-15" name="__codelineno-10-15" href="#__codelineno-10-15"></a><span class="n">rsi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SQA</span><span class="o">::</span><span class="no">TAI</span><span class="o">.</span><span class="n">rsi</span><span class="p">(</span><span class="n">prices</span><span class="p">,</span><span class="w"> </span><span class="ss">period</span><span class="p">:</span><span class="w"> </span><span class="mi">14</span><span class="p">)</span>
</span><span id="__span-10-16"><a id="__codelineno-10-16" name="__codelineno-10-16" href="#__codelineno-10-16"></a>
</span><span id="__span-10-17"><a id="__codelineno-10-17" name="__codelineno-10-17" href="#__codelineno-10-17"></a><span class="c1"># Current values</span>
</span><span id="__span-10-18"><a id="__codelineno-10-18" name="__codelineno-10-18" href="#__codelineno-10-18"></a><span class="n">current_price</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">prices</span><span class="o">.</span><span class="n">last</span>
</span><span id="__span-10-19"><a id="__codelineno-10-19" name="__codelineno-10-19" href="#__codelineno-10-19"></a><span class="n">current_trendline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">trendline</span><span class="o">.</span><span class="n">last</span>
</span><span id="__span-10-20"><a id="__codelineno-10-20" name="__codelineno-10-20" href="#__codelineno-10-20"></a><span class="n">current_mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mode</span><span class="o">.</span><span class="n">last</span>
</span><span id="__span-10-21"><a id="__codelineno-10-21" name="__codelineno-10-21" href="#__codelineno-10-21"></a><span class="n">current_cycle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cycle</span><span class="o">.</span><span class="n">last</span><span class="o">.</span><span class="n">round</span>
</span><span id="__span-10-22"><a id="__codelineno-10-22" name="__codelineno-10-22" href="#__codelineno-10-22"></a><span class="n">current_atr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">atr</span><span class="o">.</span><span class="n">last</span>
</span><span id="__span-10-23"><a id="__codelineno-10-23" name="__codelineno-10-23" href="#__codelineno-10-23"></a><span class="n">current_rsi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rsi</span><span class="o">.</span><span class="n">last</span>
</span><span id="__span-10-24"><a id="__codelineno-10-24" name="__codelineno-10-24" href="#__codelineno-10-24"></a>
</span><span id="__span-10-25"><a id="__codelineno-10-25" name="__codelineno-10-25" href="#__codelineno-10-25"></a><span class="c1"># Previous values for crossover detection</span>
</span><span id="__span-10-26"><a id="__codelineno-10-26" name="__codelineno-10-26" href="#__codelineno-10-26"></a><span class="n">prev_price</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">prices</span><span class="o">[-</span><span class="mi">2</span><span class="o">]</span>
</span><span id="__span-10-27"><a id="__codelineno-10-27" name="__codelineno-10-27" href="#__codelineno-10-27"></a><span class="n">prev_trendline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">trendline</span><span class="o">[-</span><span class="mi">2</span><span class="o">]</span>
</span><span id="__span-10-28"><a id="__codelineno-10-28" name="__codelineno-10-28" href="#__codelineno-10-28"></a>
</span><span id="__span-10-29"><a id="__codelineno-10-29" name="__codelineno-10-29" href="#__codelineno-10-29"></a><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;=&quot;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">60</span>
</span><span id="__span-10-30"><a id="__codelineno-10-30" name="__codelineno-10-30" href="#__codelineno-10-30"></a><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;HT_TRENDLINE ADAPTIVE TREND FOLLOWING SYSTEM&quot;</span>
</span><span id="__span-10-31"><a id="__codelineno-10-31" name="__codelineno-10-31" href="#__codelineno-10-31"></a><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;=&quot;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">60</span>
</span><span id="__span-10-32"><a id="__codelineno-10-32" name="__codelineno-10-32" href="#__codelineno-10-32"></a><span class="nb">puts</span>
</span><span id="__span-10-33"><a id="__codelineno-10-33" name="__codelineno-10-33" href="#__codelineno-10-33"></a>
</span><span id="__span-10-34"><a id="__codelineno-10-34" name="__codelineno-10-34" href="#__codelineno-10-34"></a><span class="c1"># Market regime analysis</span>
</span><span id="__span-10-35"><a id="__codelineno-10-35" name="__codelineno-10-35" href="#__codelineno-10-35"></a><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;MARKET ANALYSIS&quot;</span>
</span><span id="__span-10-36"><a id="__codelineno-10-36" name="__codelineno-10-36" href="#__codelineno-10-36"></a><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;-&quot;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">60</span>
</span><span id="__span-10-37"><a id="__codelineno-10-37" name="__codelineno-10-37" href="#__codelineno-10-37"></a><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Current Price: </span><span class="si">#{</span><span class="n">current_price</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-10-38"><a id="__codelineno-10-38" name="__codelineno-10-38" href="#__codelineno-10-38"></a><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Adaptive Trendline: </span><span class="si">#{</span><span class="n">current_trendline</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-10-39"><a id="__codelineno-10-39" name="__codelineno-10-39" href="#__codelineno-10-39"></a><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Market Mode: </span><span class="si">#{</span><span class="n">current_mode</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;TREND&#39;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;CYCLE&#39;</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-10-40"><a id="__codelineno-10-40" name="__codelineno-10-40" href="#__codelineno-10-40"></a><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Dominant Cycle: </span><span class="si">#{</span><span class="n">current_cycle</span><span class="si">}</span><span class="s2"> periods&quot;</span>
</span><span id="__span-10-41"><a id="__codelineno-10-41" name="__codelineno-10-41" href="#__codelineno-10-41"></a><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;ATR: </span><span class="si">#{</span><span class="n">current_atr</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-10-42"><a id="__codelineno-10-42" name="__codelineno-10-42" href="#__codelineno-10-42"></a><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;RSI: </span><span class="si">#{</span><span class="n">current_rsi</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-10-43"><a id="__codelineno-10-43" name="__codelineno-10-43" href="#__codelineno-10-43"></a><span class="nb">puts</span>
</span><span id="__span-10-44"><a id="__codelineno-10-44" name="__codelineno-10-44" href="#__codelineno-10-44"></a>
</span><span id="__span-10-45"><a id="__codelineno-10-45" name="__codelineno-10-45" href="#__codelineno-10-45"></a><span class="c1"># Calculate trend characteristics</span>
</span><span id="__span-10-46"><a id="__codelineno-10-46" name="__codelineno-10-46" href="#__codelineno-10-46"></a><span class="n">price_above_trendline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">current_price</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">current_trendline</span>
</span><span id="__span-10-47"><a id="__codelineno-10-47" name="__codelineno-10-47" href="#__codelineno-10-47"></a><span class="n">distance_from_trendline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">current_price</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">current_trendline</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span>
</span><span id="__span-10-48"><a id="__codelineno-10-48" name="__codelineno-10-48" href="#__codelineno-10-48"></a><span class="n">distance_pct</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">distance_from_trendline</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">current_price</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="p">)</span>
</span><span id="__span-10-49"><a id="__codelineno-10-49" name="__codelineno-10-49" href="#__codelineno-10-49"></a>
</span><span id="__span-10-50"><a id="__codelineno-10-50" name="__codelineno-10-50" href="#__codelineno-10-50"></a><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;TREND STATUS&quot;</span>
</span><span id="__span-10-51"><a id="__codelineno-10-51" name="__codelineno-10-51" href="#__codelineno-10-51"></a><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;-&quot;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">60</span>
</span><span id="__span-10-52"><a id="__codelineno-10-52" name="__codelineno-10-52" href="#__codelineno-10-52"></a><span class="k">if</span><span class="w"> </span><span class="n">price_above_trendline</span>
</span><span id="__span-10-53"><a id="__codelineno-10-53" name="__codelineno-10-53" href="#__codelineno-10-53"></a><span class="w">  </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Trend Direction: UPTREND&quot;</span>
</span><span id="__span-10-54"><a id="__codelineno-10-54" name="__codelineno-10-54" href="#__codelineno-10-54"></a><span class="w">  </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Trendline Support: </span><span class="si">#{</span><span class="n">current_trendline</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-10-55"><a id="__codelineno-10-55" name="__codelineno-10-55" href="#__codelineno-10-55"></a><span class="k">else</span>
</span><span id="__span-10-56"><a id="__codelineno-10-56" name="__codelineno-10-56" href="#__codelineno-10-56"></a><span class="w">  </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Trend Direction: DOWNTREND&quot;</span>
</span><span id="__span-10-57"><a id="__codelineno-10-57" name="__codelineno-10-57" href="#__codelineno-10-57"></a><span class="w">  </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Trendline Resistance: </span><span class="si">#{</span><span class="n">current_trendline</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-10-58"><a id="__codelineno-10-58" name="__codelineno-10-58" href="#__codelineno-10-58"></a><span class="k">end</span>
</span><span id="__span-10-59"><a id="__codelineno-10-59" name="__codelineno-10-59" href="#__codelineno-10-59"></a><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Distance from Trendline: </span><span class="si">#{</span><span class="n">distance_from_trendline</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2"> (</span><span class="si">#{</span><span class="n">distance_pct</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">%)&quot;</span>
</span><span id="__span-10-60"><a id="__codelineno-10-60" name="__codelineno-10-60" href="#__codelineno-10-60"></a><span class="nb">puts</span>
</span><span id="__span-10-61"><a id="__codelineno-10-61" name="__codelineno-10-61" href="#__codelineno-10-61"></a>
</span><span id="__span-10-62"><a id="__codelineno-10-62" name="__codelineno-10-62" href="#__codelineno-10-62"></a><span class="c1"># Detect crossovers</span>
</span><span id="__span-10-63"><a id="__codelineno-10-63" name="__codelineno-10-63" href="#__codelineno-10-63"></a><span class="n">bullish_crossover</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">prev_price</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">prev_trendline</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">current_price</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">current_trendline</span>
</span><span id="__span-10-64"><a id="__codelineno-10-64" name="__codelineno-10-64" href="#__codelineno-10-64"></a><span class="n">bearish_crossover</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">prev_price</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">prev_trendline</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">current_price</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">current_trendline</span>
</span><span id="__span-10-65"><a id="__codelineno-10-65" name="__codelineno-10-65" href="#__codelineno-10-65"></a>
</span><span id="__span-10-66"><a id="__codelineno-10-66" name="__codelineno-10-66" href="#__codelineno-10-66"></a><span class="c1"># Generate trading signals</span>
</span><span id="__span-10-67"><a id="__codelineno-10-67" name="__codelineno-10-67" href="#__codelineno-10-67"></a><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;TRADING SIGNALS&quot;</span>
</span><span id="__span-10-68"><a id="__codelineno-10-68" name="__codelineno-10-68" href="#__codelineno-10-68"></a><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;-&quot;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">60</span>
</span><span id="__span-10-69"><a id="__codelineno-10-69" name="__codelineno-10-69" href="#__codelineno-10-69"></a>
</span><span id="__span-10-70"><a id="__codelineno-10-70" name="__codelineno-10-70" href="#__codelineno-10-70"></a><span class="c1"># Only trade in trend mode</span>
</span><span id="__span-10-71"><a id="__codelineno-10-71" name="__codelineno-10-71" href="#__codelineno-10-71"></a><span class="k">if</span><span class="w"> </span><span class="n">current_mode</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span>
</span><span id="__span-10-72"><a id="__codelineno-10-72" name="__codelineno-10-72" href="#__codelineno-10-72"></a><span class="w">  </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Market Mode: TREND - Trendline signals ACTIVE&quot;</span>
</span><span id="__span-10-73"><a id="__codelineno-10-73" name="__codelineno-10-73" href="#__codelineno-10-73"></a><span class="w">  </span><span class="nb">puts</span>
</span><span id="__span-10-74"><a id="__codelineno-10-74" name="__codelineno-10-74" href="#__codelineno-10-74"></a>
</span><span id="__span-10-75"><a id="__codelineno-10-75" name="__codelineno-10-75" href="#__codelineno-10-75"></a><span class="w">  </span><span class="c1"># Bullish crossover signal</span>
</span><span id="__span-10-76"><a id="__codelineno-10-76" name="__codelineno-10-76" href="#__codelineno-10-76"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="n">bullish_crossover</span>
</span><span id="__span-10-77"><a id="__codelineno-10-77" name="__codelineno-10-77" href="#__codelineno-10-77"></a><span class="w">    </span><span class="n">entry</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">current_price</span>
</span><span id="__span-10-78"><a id="__codelineno-10-78" name="__codelineno-10-78" href="#__codelineno-10-78"></a><span class="w">    </span><span class="n">stop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">current_trendline</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="o">.</span><span class="mi">0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">current_atr</span><span class="p">)</span>
</span><span id="__span-10-79"><a id="__codelineno-10-79" name="__codelineno-10-79" href="#__codelineno-10-79"></a><span class="w">    </span><span class="n">target</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">current_price</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="o">.</span><span class="mi">0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">current_atr</span><span class="p">)</span>
</span><span id="__span-10-80"><a id="__codelineno-10-80" name="__codelineno-10-80" href="#__codelineno-10-80"></a><span class="w">    </span><span class="n">risk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">entry</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">stop</span>
</span><span id="__span-10-81"><a id="__codelineno-10-81" name="__codelineno-10-81" href="#__codelineno-10-81"></a><span class="w">    </span><span class="n">reward</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">target</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">entry</span>
</span><span id="__span-10-82"><a id="__codelineno-10-82" name="__codelineno-10-82" href="#__codelineno-10-82"></a><span class="w">    </span><span class="n">rr_ratio</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reward</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">risk</span>
</span><span id="__span-10-83"><a id="__codelineno-10-83" name="__codelineno-10-83" href="#__codelineno-10-83"></a>
</span><span id="__span-10-84"><a id="__codelineno-10-84" name="__codelineno-10-84" href="#__codelineno-10-84"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;BULLISH CROSSOVER DETECTED&quot;</span>
</span><span id="__span-10-85"><a id="__codelineno-10-85" name="__codelineno-10-85" href="#__codelineno-10-85"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;=&quot;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">60</span>
</span><span id="__span-10-86"><a id="__codelineno-10-86" name="__codelineno-10-86" href="#__codelineno-10-86"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Signal: BUY (Long Entry)&quot;</span>
</span><span id="__span-10-87"><a id="__codelineno-10-87" name="__codelineno-10-87" href="#__codelineno-10-87"></a><span class="w">    </span><span class="nb">puts</span>
</span><span id="__span-10-88"><a id="__codelineno-10-88" name="__codelineno-10-88" href="#__codelineno-10-88"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Entry Price: </span><span class="si">#{</span><span class="n">entry</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-10-89"><a id="__codelineno-10-89" name="__codelineno-10-89" href="#__codelineno-10-89"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Stop Loss: </span><span class="si">#{</span><span class="n">stop</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2"> (below trendline - 2*ATR)&quot;</span>
</span><span id="__span-10-90"><a id="__codelineno-10-90" name="__codelineno-10-90" href="#__codelineno-10-90"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Take Profit: </span><span class="si">#{</span><span class="n">target</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2"> (3*ATR target)&quot;</span>
</span><span id="__span-10-91"><a id="__codelineno-10-91" name="__codelineno-10-91" href="#__codelineno-10-91"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Risk: </span><span class="si">#{</span><span class="n">risk</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-10-92"><a id="__codelineno-10-92" name="__codelineno-10-92" href="#__codelineno-10-92"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Reward: </span><span class="si">#{</span><span class="n">reward</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-10-93"><a id="__codelineno-10-93" name="__codelineno-10-93" href="#__codelineno-10-93"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Risk/Reward: 1:</span><span class="si">#{</span><span class="n">rr_ratio</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-10-94"><a id="__codelineno-10-94" name="__codelineno-10-94" href="#__codelineno-10-94"></a><span class="w">    </span><span class="nb">puts</span>
</span><span id="__span-10-95"><a id="__codelineno-10-95" name="__codelineno-10-95" href="#__codelineno-10-95"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Position Management:&quot;</span>
</span><span id="__span-10-96"><a id="__codelineno-10-96" name="__codelineno-10-96" href="#__codelineno-10-96"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;- Trail stop to (trendline - 1*ATR) as trade progresses&quot;</span>
</span><span id="__span-10-97"><a id="__codelineno-10-97" name="__codelineno-10-97" href="#__codelineno-10-97"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;- Exit if price closes below trendline&quot;</span>
</span><span id="__span-10-98"><a id="__codelineno-10-98" name="__codelineno-10-98" href="#__codelineno-10-98"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;- Consider taking partial profits at 2*ATR&quot;</span>
</span><span id="__span-10-99"><a id="__codelineno-10-99" name="__codelineno-10-99" href="#__codelineno-10-99"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;- Hold remainder for full target&quot;</span>
</span><span id="__span-10-100"><a id="__codelineno-10-100" name="__codelineno-10-100" href="#__codelineno-10-100"></a>
</span><span id="__span-10-101"><a id="__codelineno-10-101" name="__codelineno-10-101" href="#__codelineno-10-101"></a><span class="w">  </span><span class="c1"># Bearish crossover signal</span>
</span><span id="__span-10-102"><a id="__codelineno-10-102" name="__codelineno-10-102" href="#__codelineno-10-102"></a><span class="w">  </span><span class="k">elsif</span><span class="w"> </span><span class="n">bearish_crossover</span>
</span><span id="__span-10-103"><a id="__codelineno-10-103" name="__codelineno-10-103" href="#__codelineno-10-103"></a><span class="w">    </span><span class="n">entry</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">current_price</span>
</span><span id="__span-10-104"><a id="__codelineno-10-104" name="__codelineno-10-104" href="#__codelineno-10-104"></a><span class="w">    </span><span class="n">stop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">current_trendline</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="o">.</span><span class="mi">0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">current_atr</span><span class="p">)</span>
</span><span id="__span-10-105"><a id="__codelineno-10-105" name="__codelineno-10-105" href="#__codelineno-10-105"></a><span class="w">    </span><span class="n">target</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">current_price</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="o">.</span><span class="mi">0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">current_atr</span><span class="p">)</span>
</span><span id="__span-10-106"><a id="__codelineno-10-106" name="__codelineno-10-106" href="#__codelineno-10-106"></a><span class="w">    </span><span class="n">risk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stop</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">entry</span>
</span><span id="__span-10-107"><a id="__codelineno-10-107" name="__codelineno-10-107" href="#__codelineno-10-107"></a><span class="w">    </span><span class="n">reward</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">entry</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">target</span>
</span><span id="__span-10-108"><a id="__codelineno-10-108" name="__codelineno-10-108" href="#__codelineno-10-108"></a><span class="w">    </span><span class="n">rr_ratio</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reward</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">risk</span>
</span><span id="__span-10-109"><a id="__codelineno-10-109" name="__codelineno-10-109" href="#__codelineno-10-109"></a>
</span><span id="__span-10-110"><a id="__codelineno-10-110" name="__codelineno-10-110" href="#__codelineno-10-110"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;BEARISH CROSSOVER DETECTED&quot;</span>
</span><span id="__span-10-111"><a id="__codelineno-10-111" name="__codelineno-10-111" href="#__codelineno-10-111"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;=&quot;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">60</span>
</span><span id="__span-10-112"><a id="__codelineno-10-112" name="__codelineno-10-112" href="#__codelineno-10-112"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Signal: SELL (Short Entry or Exit Long)&quot;</span>
</span><span id="__span-10-113"><a id="__codelineno-10-113" name="__codelineno-10-113" href="#__codelineno-10-113"></a><span class="w">    </span><span class="nb">puts</span>
</span><span id="__span-10-114"><a id="__codelineno-10-114" name="__codelineno-10-114" href="#__codelineno-10-114"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Entry Price: </span><span class="si">#{</span><span class="n">entry</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-10-115"><a id="__codelineno-10-115" name="__codelineno-10-115" href="#__codelineno-10-115"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Stop Loss: </span><span class="si">#{</span><span class="n">stop</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2"> (above trendline + 2*ATR)&quot;</span>
</span><span id="__span-10-116"><a id="__codelineno-10-116" name="__codelineno-10-116" href="#__codelineno-10-116"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Take Profit: </span><span class="si">#{</span><span class="n">target</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2"> (3*ATR target)&quot;</span>
</span><span id="__span-10-117"><a id="__codelineno-10-117" name="__codelineno-10-117" href="#__codelineno-10-117"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Risk: </span><span class="si">#{</span><span class="n">risk</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-10-118"><a id="__codelineno-10-118" name="__codelineno-10-118" href="#__codelineno-10-118"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Reward: </span><span class="si">#{</span><span class="n">reward</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-10-119"><a id="__codelineno-10-119" name="__codelineno-10-119" href="#__codelineno-10-119"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Risk/Reward: 1:</span><span class="si">#{</span><span class="n">rr_ratio</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-10-120"><a id="__codelineno-10-120" name="__codelineno-10-120" href="#__codelineno-10-120"></a><span class="w">    </span><span class="nb">puts</span>
</span><span id="__span-10-121"><a id="__codelineno-10-121" name="__codelineno-10-121" href="#__codelineno-10-121"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Position Management:&quot;</span>
</span><span id="__span-10-122"><a id="__codelineno-10-122" name="__codelineno-10-122" href="#__codelineno-10-122"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;- Trail stop to (trendline + 1*ATR) as trade progresses&quot;</span>
</span><span id="__span-10-123"><a id="__codelineno-10-123" name="__codelineno-10-123" href="#__codelineno-10-123"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;- Exit if price closes above trendline&quot;</span>
</span><span id="__span-10-124"><a id="__codelineno-10-124" name="__codelineno-10-124" href="#__codelineno-10-124"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;- Consider taking partial profits at 2*ATR&quot;</span>
</span><span id="__span-10-125"><a id="__codelineno-10-125" name="__codelineno-10-125" href="#__codelineno-10-125"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;- Hold remainder for full target&quot;</span>
</span><span id="__span-10-126"><a id="__codelineno-10-126" name="__codelineno-10-126" href="#__codelineno-10-126"></a>
</span><span id="__span-10-127"><a id="__codelineno-10-127" name="__codelineno-10-127" href="#__codelineno-10-127"></a><span class="w">  </span><span class="c1"># No crossover - check for pullback opportunities</span>
</span><span id="__span-10-128"><a id="__codelineno-10-128" name="__codelineno-10-128" href="#__codelineno-10-128"></a><span class="w">  </span><span class="k">else</span>
</span><span id="__span-10-129"><a id="__codelineno-10-129" name="__codelineno-10-129" href="#__codelineno-10-129"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;No crossover detected - analyzing pullback opportunities&quot;</span>
</span><span id="__span-10-130"><a id="__codelineno-10-130" name="__codelineno-10-130" href="#__codelineno-10-130"></a><span class="w">    </span><span class="nb">puts</span>
</span><span id="__span-10-131"><a id="__codelineno-10-131" name="__codelineno-10-131" href="#__codelineno-10-131"></a>
</span><span id="__span-10-132"><a id="__codelineno-10-132" name="__codelineno-10-132" href="#__codelineno-10-132"></a><span class="w">    </span><span class="c1"># Uptrend pullback</span>
</span><span id="__span-10-133"><a id="__codelineno-10-133" name="__codelineno-10-133" href="#__codelineno-10-133"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">price_above_trendline</span>
</span><span id="__span-10-134"><a id="__codelineno-10-134" name="__codelineno-10-134" href="#__codelineno-10-134"></a><span class="w">      </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Current Uptrend: Look for pullback entries&quot;</span>
</span><span id="__span-10-135"><a id="__codelineno-10-135" name="__codelineno-10-135" href="#__codelineno-10-135"></a>
</span><span id="__span-10-136"><a id="__codelineno-10-136" name="__codelineno-10-136" href="#__codelineno-10-136"></a><span class="w">      </span><span class="c1"># Check if near trendline</span>
</span><span id="__span-10-137"><a id="__codelineno-10-137" name="__codelineno-10-137" href="#__codelineno-10-137"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="n">distance_pct</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">2</span><span class="o">.</span><span class="mi">0</span>
</span><span id="__span-10-138"><a id="__codelineno-10-138" name="__codelineno-10-138" href="#__codelineno-10-138"></a><span class="w">        </span><span class="nb">puts</span>
</span><span id="__span-10-139"><a id="__codelineno-10-139" name="__codelineno-10-139" href="#__codelineno-10-139"></a><span class="w">        </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;PULLBACK BUY OPPORTUNITY&quot;</span>
</span><span id="__span-10-140"><a id="__codelineno-10-140" name="__codelineno-10-140" href="#__codelineno-10-140"></a><span class="w">        </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Price near trendline support: </span><span class="si">#{</span><span class="n">current_trendline</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-10-141"><a id="__codelineno-10-141" name="__codelineno-10-141" href="#__codelineno-10-141"></a><span class="w">        </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Current price: </span><span class="si">#{</span><span class="n">current_price</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-10-142"><a id="__codelineno-10-142" name="__codelineno-10-142" href="#__codelineno-10-142"></a>
</span><span id="__span-10-143"><a id="__codelineno-10-143" name="__codelineno-10-143" href="#__codelineno-10-143"></a><span class="w">        </span><span class="c1"># RSI confirmation</span>
</span><span id="__span-10-144"><a id="__codelineno-10-144" name="__codelineno-10-144" href="#__codelineno-10-144"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">current_rsi</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">50</span>
</span><span id="__span-10-145"><a id="__codelineno-10-145" name="__codelineno-10-145" href="#__codelineno-10-145"></a><span class="w">          </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;RSI: </span><span class="si">#{</span><span class="n">current_rsi</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2"> (oversold in uptrend)&quot;</span>
</span><span id="__span-10-146"><a id="__codelineno-10-146" name="__codelineno-10-146" href="#__codelineno-10-146"></a><span class="w">          </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;STRONG BUY SETUP: Uptrend + Pullback + RSI confirmation&quot;</span>
</span><span id="__span-10-147"><a id="__codelineno-10-147" name="__codelineno-10-147" href="#__codelineno-10-147"></a><span class="w">          </span><span class="nb">puts</span>
</span><span id="__span-10-148"><a id="__codelineno-10-148" name="__codelineno-10-148" href="#__codelineno-10-148"></a><span class="w">          </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Suggested Entry: </span><span class="si">#{</span><span class="n">current_price</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-10-149"><a id="__codelineno-10-149" name="__codelineno-10-149" href="#__codelineno-10-149"></a><span class="w">          </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Stop: </span><span class="si">#{</span><span class="p">(</span><span class="n">current_trendline</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="o">.</span><span class="mi">5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">current_atr</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-10-150"><a id="__codelineno-10-150" name="__codelineno-10-150" href="#__codelineno-10-150"></a><span class="w">          </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Target: </span><span class="si">#{</span><span class="p">(</span><span class="n">current_price</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">current_atr</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-10-151"><a id="__codelineno-10-151" name="__codelineno-10-151" href="#__codelineno-10-151"></a><span class="w">        </span><span class="k">else</span>
</span><span id="__span-10-152"><a id="__codelineno-10-152" name="__codelineno-10-152" href="#__codelineno-10-152"></a><span class="w">          </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;RSI: </span><span class="si">#{</span><span class="n">current_rsi</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2"> (wait for deeper pullback)&quot;</span>
</span><span id="__span-10-153"><a id="__codelineno-10-153" name="__codelineno-10-153" href="#__codelineno-10-153"></a><span class="w">        </span><span class="k">end</span>
</span><span id="__span-10-154"><a id="__codelineno-10-154" name="__codelineno-10-154" href="#__codelineno-10-154"></a><span class="w">      </span><span class="k">else</span>
</span><span id="__span-10-155"><a id="__codelineno-10-155" name="__codelineno-10-155" href="#__codelineno-10-155"></a><span class="w">        </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Price </span><span class="si">#{</span><span class="n">distance_pct</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">% above trendline&quot;</span>
</span><span id="__span-10-156"><a id="__codelineno-10-156" name="__codelineno-10-156" href="#__codelineno-10-156"></a><span class="w">        </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Wait for pullback closer to trendline support&quot;</span>
</span><span id="__span-10-157"><a id="__codelineno-10-157" name="__codelineno-10-157" href="#__codelineno-10-157"></a><span class="w">      </span><span class="k">end</span>
</span><span id="__span-10-158"><a id="__codelineno-10-158" name="__codelineno-10-158" href="#__codelineno-10-158"></a>
</span><span id="__span-10-159"><a id="__codelineno-10-159" name="__codelineno-10-159" href="#__codelineno-10-159"></a><span class="w">    </span><span class="c1"># Downtrend rally</span>
</span><span id="__span-10-160"><a id="__codelineno-10-160" name="__codelineno-10-160" href="#__codelineno-10-160"></a><span class="w">    </span><span class="k">else</span>
</span><span id="__span-10-161"><a id="__codelineno-10-161" name="__codelineno-10-161" href="#__codelineno-10-161"></a><span class="w">      </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Current Downtrend: Look for rally sell opportunities&quot;</span>
</span><span id="__span-10-162"><a id="__codelineno-10-162" name="__codelineno-10-162" href="#__codelineno-10-162"></a>
</span><span id="__span-10-163"><a id="__codelineno-10-163" name="__codelineno-10-163" href="#__codelineno-10-163"></a><span class="w">      </span><span class="c1"># Check if near trendline</span>
</span><span id="__span-10-164"><a id="__codelineno-10-164" name="__codelineno-10-164" href="#__codelineno-10-164"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="n">distance_pct</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">2</span><span class="o">.</span><span class="mi">0</span>
</span><span id="__span-10-165"><a id="__codelineno-10-165" name="__codelineno-10-165" href="#__codelineno-10-165"></a><span class="w">        </span><span class="nb">puts</span>
</span><span id="__span-10-166"><a id="__codelineno-10-166" name="__codelineno-10-166" href="#__codelineno-10-166"></a><span class="w">        </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;RALLY SELL OPPORTUNITY&quot;</span>
</span><span id="__span-10-167"><a id="__codelineno-10-167" name="__codelineno-10-167" href="#__codelineno-10-167"></a><span class="w">        </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Price near trendline resistance: </span><span class="si">#{</span><span class="n">current_trendline</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-10-168"><a id="__codelineno-10-168" name="__codelineno-10-168" href="#__codelineno-10-168"></a><span class="w">        </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Current price: </span><span class="si">#{</span><span class="n">current_price</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-10-169"><a id="__codelineno-10-169" name="__codelineno-10-169" href="#__codelineno-10-169"></a>
</span><span id="__span-10-170"><a id="__codelineno-10-170" name="__codelineno-10-170" href="#__codelineno-10-170"></a><span class="w">        </span><span class="c1"># RSI confirmation</span>
</span><span id="__span-10-171"><a id="__codelineno-10-171" name="__codelineno-10-171" href="#__codelineno-10-171"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">current_rsi</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">50</span>
</span><span id="__span-10-172"><a id="__codelineno-10-172" name="__codelineno-10-172" href="#__codelineno-10-172"></a><span class="w">          </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;RSI: </span><span class="si">#{</span><span class="n">current_rsi</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2"> (overbought in downtrend)&quot;</span>
</span><span id="__span-10-173"><a id="__codelineno-10-173" name="__codelineno-10-173" href="#__codelineno-10-173"></a><span class="w">          </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;STRONG SELL SETUP: Downtrend + Rally + RSI confirmation&quot;</span>
</span><span id="__span-10-174"><a id="__codelineno-10-174" name="__codelineno-10-174" href="#__codelineno-10-174"></a><span class="w">          </span><span class="nb">puts</span>
</span><span id="__span-10-175"><a id="__codelineno-10-175" name="__codelineno-10-175" href="#__codelineno-10-175"></a><span class="w">          </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Suggested Entry: </span><span class="si">#{</span><span class="n">current_price</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-10-176"><a id="__codelineno-10-176" name="__codelineno-10-176" href="#__codelineno-10-176"></a><span class="w">          </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Stop: </span><span class="si">#{</span><span class="p">(</span><span class="n">current_trendline</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="o">.</span><span class="mi">5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">current_atr</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-10-177"><a id="__codelineno-10-177" name="__codelineno-10-177" href="#__codelineno-10-177"></a><span class="w">          </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Target: </span><span class="si">#{</span><span class="p">(</span><span class="n">current_price</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">current_atr</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-10-178"><a id="__codelineno-10-178" name="__codelineno-10-178" href="#__codelineno-10-178"></a><span class="w">        </span><span class="k">else</span>
</span><span id="__span-10-179"><a id="__codelineno-10-179" name="__codelineno-10-179" href="#__codelineno-10-179"></a><span class="w">          </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;RSI: </span><span class="si">#{</span><span class="n">current_rsi</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2"> (wait for stronger rally)&quot;</span>
</span><span id="__span-10-180"><a id="__codelineno-10-180" name="__codelineno-10-180" href="#__codelineno-10-180"></a><span class="w">        </span><span class="k">end</span>
</span><span id="__span-10-181"><a id="__codelineno-10-181" name="__codelineno-10-181" href="#__codelineno-10-181"></a><span class="w">      </span><span class="k">else</span>
</span><span id="__span-10-182"><a id="__codelineno-10-182" name="__codelineno-10-182" href="#__codelineno-10-182"></a><span class="w">        </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Price </span><span class="si">#{</span><span class="n">distance_pct</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">% below trendline&quot;</span>
</span><span id="__span-10-183"><a id="__codelineno-10-183" name="__codelineno-10-183" href="#__codelineno-10-183"></a><span class="w">        </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Wait for rally closer to trendline resistance&quot;</span>
</span><span id="__span-10-184"><a id="__codelineno-10-184" name="__codelineno-10-184" href="#__codelineno-10-184"></a><span class="w">      </span><span class="k">end</span>
</span><span id="__span-10-185"><a id="__codelineno-10-185" name="__codelineno-10-185" href="#__codelineno-10-185"></a><span class="w">    </span><span class="k">end</span>
</span><span id="__span-10-186"><a id="__codelineno-10-186" name="__codelineno-10-186" href="#__codelineno-10-186"></a><span class="w">  </span><span class="k">end</span>
</span><span id="__span-10-187"><a id="__codelineno-10-187" name="__codelineno-10-187" href="#__codelineno-10-187"></a>
</span><span id="__span-10-188"><a id="__codelineno-10-188" name="__codelineno-10-188" href="#__codelineno-10-188"></a><span class="k">else</span>
</span><span id="__span-10-189"><a id="__codelineno-10-189" name="__codelineno-10-189" href="#__codelineno-10-189"></a><span class="w">  </span><span class="c1"># Cycle mode - trendline less reliable</span>
</span><span id="__span-10-190"><a id="__codelineno-10-190" name="__codelineno-10-190" href="#__codelineno-10-190"></a><span class="w">  </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Market Mode: CYCLE - Trendline signals DISABLED&quot;</span>
</span><span id="__span-10-191"><a id="__codelineno-10-191" name="__codelineno-10-191" href="#__codelineno-10-191"></a><span class="w">  </span><span class="nb">puts</span>
</span><span id="__span-10-192"><a id="__codelineno-10-192" name="__codelineno-10-192" href="#__codelineno-10-192"></a><span class="w">  </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Market is ranging/cycling - not suitable for trend-following&quot;</span>
</span><span id="__span-10-193"><a id="__codelineno-10-193" name="__codelineno-10-193" href="#__codelineno-10-193"></a><span class="w">  </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Consider using oscillators for mean-reversion instead:&quot;</span>
</span><span id="__span-10-194"><a id="__codelineno-10-194" name="__codelineno-10-194" href="#__codelineno-10-194"></a><span class="w">  </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;- RSI for overbought/oversold&quot;</span>
</span><span id="__span-10-195"><a id="__codelineno-10-195" name="__codelineno-10-195" href="#__codelineno-10-195"></a><span class="w">  </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;- Stochastic for cycle timing&quot;</span>
</span><span id="__span-10-196"><a id="__codelineno-10-196" name="__codelineno-10-196" href="#__codelineno-10-196"></a><span class="w">  </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;- Bollinger Bands for range boundaries&quot;</span>
</span><span id="__span-10-197"><a id="__codelineno-10-197" name="__codelineno-10-197" href="#__codelineno-10-197"></a><span class="w">  </span><span class="nb">puts</span>
</span><span id="__span-10-198"><a id="__codelineno-10-198" name="__codelineno-10-198" href="#__codelineno-10-198"></a><span class="w">  </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Wait for HT_TRENDMODE to switch to 1 (TREND) before using trendline&quot;</span>
</span><span id="__span-10-199"><a id="__codelineno-10-199" name="__codelineno-10-199" href="#__codelineno-10-199"></a><span class="k">end</span>
</span><span id="__span-10-200"><a id="__codelineno-10-200" name="__codelineno-10-200" href="#__codelineno-10-200"></a>
</span><span id="__span-10-201"><a id="__codelineno-10-201" name="__codelineno-10-201" href="#__codelineno-10-201"></a><span class="nb">puts</span>
</span><span id="__span-10-202"><a id="__codelineno-10-202" name="__codelineno-10-202" href="#__codelineno-10-202"></a><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;=&quot;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">60</span>
</span></code></pre></div>
<h2 id="related-indicators">Related Indicators<a class="headerlink" href="#related-indicators" title="Permanent link">&para;</a></h2>
<h3 id="hilbert-transform-family">Hilbert Transform Family<a class="headerlink" href="#hilbert-transform-family" title="Permanent link">&para;</a></h3>
<ul>
<li><strong><a href="../../cycle/ht_trendmode/">HT_TRENDMODE</a></strong>: Determines if market is trending or cycling - use as filter for HT_TRENDLINE</li>
<li><strong><a href="../../cycle/ht_dcperiod/">HT_DCPERIOD</a></strong>: Identifies the dominant cycle period that HT_TRENDLINE adapts to</li>
<li><strong><a href="../../cycle/ht_dcphase/">HT_DCPHASE</a></strong>: Shows current phase within the cycle for timing entries</li>
<li><strong><a href="../../cycle/ht_sine/">HT_SINE</a></strong>: Generates sine wave signals based on cycle analysis</li>
<li><strong><a href="../../cycle/ht_phasor/">HT_PHASOR</a></strong>: Provides in-phase and quadrature components for advanced analysis</li>
</ul>
<h3 id="complementary-indicators">Complementary Indicators<a class="headerlink" href="#complementary-indicators" title="Permanent link">&para;</a></h3>
<p><strong>For Trend Confirmation:</strong>
- <strong><a href="../../momentum/adx/">ADX</a></strong>: Confirm trend strength when using trendline
- <strong><a href="../../momentum/macd/">MACD</a></strong>: Additional momentum confirmation
- <strong><a href="../../overlap/ema/">EMA</a></strong>: Compare adaptive vs fixed-period trendlines</p>
<p><strong>For Entry Timing:</strong>
- <strong><a href="../../momentum/rsi/">RSI</a></strong>: Time pullback entries to trendline
- <strong><a href="../../momentum/stoch/">STOCH</a></strong>: Identify oversold/overbought on pullbacks
- <strong><a href="../../momentum/cci/">CCI</a></strong>: Confirm extremes at trendline tests</p>
<p><strong>For Risk Management:</strong>
- <strong><a href="../atr/">ATR</a></strong>: Volatility-based stop placement relative to trendline
- <strong><a href="../../overlap/bbands/">BBANDS</a></strong>: Identify overextended moves from trendline
- <strong><a href="../natr/">NATR</a></strong>: Normalized volatility for position sizing</p>
<h3 id="alternative-adaptive-indicators">Alternative Adaptive Indicators<a class="headerlink" href="#alternative-adaptive-indicators" title="Permanent link">&para;</a></h3>
<ul>
<li><strong><a href="../mama/">MAMA</a></strong>: MESA Adaptive Moving Average - another adaptive approach</li>
<li><strong><a href="../../overlap/kama/">KAMA</a></strong>: Kaufman Adaptive Moving Average - efficiency-based adaptation</li>
<li><strong><a href="../../overlap/t3/">T3</a></strong>: Tillson T3 - low-lag moving average (not adaptive but responsive)</li>
</ul>
<h2 id="advanced-topics">Advanced Topics<a class="headerlink" href="#advanced-topics" title="Permanent link">&para;</a></h2>
<h3 id="comparing-adaptive-vs-fixed-trendlines">Comparing Adaptive vs Fixed Trendlines<a class="headerlink" href="#comparing-adaptive-vs-fixed-trendlines" title="Permanent link">&para;</a></h3>
<div class="language-ruby highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="c1"># Compare HT_TRENDLINE adaptation to traditional MAs</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="n">trendline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SQA</span><span class="o">::</span><span class="no">TAI</span><span class="o">.</span><span class="n">ht_trendline</span><span class="p">(</span><span class="n">prices</span><span class="p">)</span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="n">sma_10</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SQA</span><span class="o">::</span><span class="no">TAI</span><span class="o">.</span><span class="n">sma</span><span class="p">(</span><span class="n">prices</span><span class="p">,</span><span class="w"> </span><span class="ss">period</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="n">sma_20</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SQA</span><span class="o">::</span><span class="no">TAI</span><span class="o">.</span><span class="n">sma</span><span class="p">(</span><span class="n">prices</span><span class="p">,</span><span class="w"> </span><span class="ss">period</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="p">)</span>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="n">sma_30</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SQA</span><span class="o">::</span><span class="no">TAI</span><span class="o">.</span><span class="n">sma</span><span class="p">(</span><span class="n">prices</span><span class="p">,</span><span class="w"> </span><span class="ss">period</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="p">)</span>
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="n">ema_20</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SQA</span><span class="o">::</span><span class="no">TAI</span><span class="o">.</span><span class="n">ema</span><span class="p">(</span><span class="n">prices</span><span class="p">,</span><span class="w"> </span><span class="ss">period</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="p">)</span>
</span><span id="__span-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a>
</span><span id="__span-11-8"><a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a><span class="c1"># Analyze lag characteristics</span>
</span><span id="__span-11-9"><a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a><span class="n">prices</span><span class="o">.</span><span class="n">each_with_index</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="o">|</span><span class="n">price</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="o">|</span>
</span><span id="__span-11-10"><a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a><span class="w">  </span><span class="k">next</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">30</span><span class="w">  </span><span class="c1"># Skip initial unstable period</span>
</span><span id="__span-11-11"><a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a>
</span><span id="__span-11-12"><a id="__codelineno-11-12" name="__codelineno-11-12" href="#__codelineno-11-12"></a><span class="w">  </span><span class="n">ht_lag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">price</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">trendline</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span>
</span><span id="__span-11-13"><a id="__codelineno-11-13" name="__codelineno-11-13" href="#__codelineno-11-13"></a><span class="w">  </span><span class="n">sma10_lag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">price</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sma_10</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span>
</span><span id="__span-11-14"><a id="__codelineno-11-14" name="__codelineno-11-14" href="#__codelineno-11-14"></a><span class="w">  </span><span class="n">sma20_lag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">price</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sma_20</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span>
</span><span id="__span-11-15"><a id="__codelineno-11-15" name="__codelineno-11-15" href="#__codelineno-11-15"></a><span class="w">  </span><span class="n">sma30_lag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">price</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sma_30</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span>
</span><span id="__span-11-16"><a id="__codelineno-11-16" name="__codelineno-11-16" href="#__codelineno-11-16"></a><span class="w">  </span><span class="n">ema20_lag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">price</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ema_20</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span>
</span><span id="__span-11-17"><a id="__codelineno-11-17" name="__codelineno-11-17" href="#__codelineno-11-17"></a>
</span><span id="__span-11-18"><a id="__codelineno-11-18" name="__codelineno-11-18" href="#__codelineno-11-18"></a><span class="w">  </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Bar </span><span class="si">#{</span><span class="n">i</span><span class="si">}</span><span class="s2">: Price=</span><span class="si">#{</span><span class="n">price</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-11-19"><a id="__codelineno-11-19" name="__codelineno-11-19" href="#__codelineno-11-19"></a><span class="w">  </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;  HT Trendline lag: </span><span class="si">#{</span><span class="n">ht_lag</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-11-20"><a id="__codelineno-11-20" name="__codelineno-11-20" href="#__codelineno-11-20"></a><span class="w">  </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;  SMA(10) lag: </span><span class="si">#{</span><span class="n">sma10_lag</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-11-21"><a id="__codelineno-11-21" name="__codelineno-11-21" href="#__codelineno-11-21"></a><span class="w">  </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;  SMA(20) lag: </span><span class="si">#{</span><span class="n">sma20_lag</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-11-22"><a id="__codelineno-11-22" name="__codelineno-11-22" href="#__codelineno-11-22"></a><span class="w">  </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;  SMA(30) lag: </span><span class="si">#{</span><span class="n">sma30_lag</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-11-23"><a id="__codelineno-11-23" name="__codelineno-11-23" href="#__codelineno-11-23"></a><span class="w">  </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;  EMA(20) lag: </span><span class="si">#{</span><span class="n">ema20_lag</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-11-24"><a id="__codelineno-11-24" name="__codelineno-11-24" href="#__codelineno-11-24"></a><span class="k">end</span>
</span><span id="__span-11-25"><a id="__codelineno-11-25" name="__codelineno-11-25" href="#__codelineno-11-25"></a>
</span><span id="__span-11-26"><a id="__codelineno-11-26" name="__codelineno-11-26" href="#__codelineno-11-26"></a><span class="c1"># HT_TRENDLINE typically shows:</span>
</span><span id="__span-11-27"><a id="__codelineno-11-27" name="__codelineno-11-27" href="#__codelineno-11-27"></a><span class="c1"># - Less lag than SMA(20) with comparable smoothness</span>
</span><span id="__span-11-28"><a id="__codelineno-11-28" name="__codelineno-11-28" href="#__codelineno-11-28"></a><span class="c1"># - More smoothness than SMA(10) with comparable responsiveness</span>
</span><span id="__span-11-29"><a id="__codelineno-11-29" name="__codelineno-11-29" href="#__codelineno-11-29"></a><span class="c1"># - Automatic optimization without parameter adjustment</span>
</span></code></pre></div>
<h3 id="multi-timeframe-trendline-analysis">Multi-Timeframe Trendline Analysis<a class="headerlink" href="#multi-timeframe-trendline-analysis" title="Permanent link">&para;</a></h3>
<div class="language-ruby highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="c1"># Align trendlines across timeframes for high-confidence signals</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="n">daily_prices</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[...]</span><span class="w">    </span><span class="c1"># Daily data</span>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="n">hourly_prices</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[...]</span><span class="w">   </span><span class="c1"># Hourly data</span>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="n">daily_trendline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SQA</span><span class="o">::</span><span class="no">TAI</span><span class="o">.</span><span class="n">ht_trendline</span><span class="p">(</span><span class="n">daily_prices</span><span class="p">)</span>
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a><span class="n">hourly_trendline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SQA</span><span class="o">::</span><span class="no">TAI</span><span class="o">.</span><span class="n">ht_trendline</span><span class="p">(</span><span class="n">hourly_prices</span><span class="p">)</span>
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a>
</span><span id="__span-12-8"><a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a><span class="n">daily_price</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">daily_prices</span><span class="o">.</span><span class="n">last</span>
</span><span id="__span-12-9"><a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a><span class="n">hourly_price</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hourly_prices</span><span class="o">.</span><span class="n">last</span>
</span><span id="__span-12-10"><a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a><span class="n">daily_trend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">daily_trendline</span><span class="o">.</span><span class="n">last</span>
</span><span id="__span-12-11"><a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a><span class="n">hourly_trend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hourly_trendline</span><span class="o">.</span><span class="n">last</span>
</span><span id="__span-12-12"><a id="__codelineno-12-12" name="__codelineno-12-12" href="#__codelineno-12-12"></a>
</span><span id="__span-12-13"><a id="__codelineno-12-13" name="__codelineno-12-13" href="#__codelineno-12-13"></a><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Daily: </span><span class="si">#{</span><span class="n">daily_price</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">daily_trend</span><span class="w"> </span><span class="p">?</span><span class="w"> </span><span class="s1">&#39;UPTREND&#39;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;DOWNTREND&#39;</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-12-14"><a id="__codelineno-12-14" name="__codelineno-12-14" href="#__codelineno-12-14"></a><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Hourly: </span><span class="si">#{</span><span class="n">hourly_price</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">hourly_trend</span><span class="w"> </span><span class="p">?</span><span class="w"> </span><span class="s1">&#39;UPTREND&#39;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;DOWNTREND&#39;</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-12-15"><a id="__codelineno-12-15" name="__codelineno-12-15" href="#__codelineno-12-15"></a>
</span><span id="__span-12-16"><a id="__codelineno-12-16" name="__codelineno-12-16" href="#__codelineno-12-16"></a><span class="c1"># Highest confidence when both aligned</span>
</span><span id="__span-12-17"><a id="__codelineno-12-17" name="__codelineno-12-17" href="#__codelineno-12-17"></a><span class="k">if</span><span class="w"> </span><span class="n">daily_price</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">daily_trend</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">hourly_price</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">hourly_trend</span>
</span><span id="__span-12-18"><a id="__codelineno-12-18" name="__codelineno-12-18" href="#__codelineno-12-18"></a><span class="w">  </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;ALIGNED UPTREND - Highest confidence long signals&quot;</span>
</span><span id="__span-12-19"><a id="__codelineno-12-19" name="__codelineno-12-19" href="#__codelineno-12-19"></a><span class="k">elsif</span><span class="w"> </span><span class="n">daily_price</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">daily_trend</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">hourly_price</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">hourly_trend</span>
</span><span id="__span-12-20"><a id="__codelineno-12-20" name="__codelineno-12-20" href="#__codelineno-12-20"></a><span class="w">  </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;ALIGNED DOWNTREND - Highest confidence short signals&quot;</span>
</span><span id="__span-12-21"><a id="__codelineno-12-21" name="__codelineno-12-21" href="#__codelineno-12-21"></a><span class="k">else</span>
</span><span id="__span-12-22"><a id="__codelineno-12-22" name="__codelineno-12-22" href="#__codelineno-12-22"></a><span class="w">  </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;MIXED SIGNALS - Use caution, possible consolidation&quot;</span>
</span><span id="__span-12-23"><a id="__codelineno-12-23" name="__codelineno-12-23" href="#__codelineno-12-23"></a><span class="k">end</span>
</span></code></pre></div>
<h3 id="trendline-as-dynamic-supportresistance">Trendline as Dynamic Support/Resistance<a class="headerlink" href="#trendline-as-dynamic-supportresistance" title="Permanent link">&para;</a></h3>
<div class="language-ruby highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="c1"># Track how price respects trendline as support/resistance</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="n">trendline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SQA</span><span class="o">::</span><span class="no">TAI</span><span class="o">.</span><span class="n">ht_trendline</span><span class="p">(</span><span class="n">prices</span><span class="p">)</span>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="n">touches</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="n">bounces</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a>
</span><span id="__span-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a><span class="n">prices</span><span class="o">.</span><span class="n">each_with_index</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="o">|</span><span class="n">price</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="o">|</span>
</span><span id="__span-13-7"><a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a><span class="w">  </span><span class="k">next</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">63</span><span class="w">  </span><span class="c1"># Skip initial period</span>
</span><span id="__span-13-8"><a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a>
</span><span id="__span-13-9"><a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a><span class="w">  </span><span class="n">trend_val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">trendline</span><span class="o">[</span><span class="n">i</span><span class="o">]</span>
</span><span id="__span-13-10"><a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a><span class="w">  </span><span class="n">prev_trend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">trendline</span><span class="o">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="o">]</span>
</span><span id="__span-13-11"><a id="__codelineno-13-11" name="__codelineno-13-11" href="#__codelineno-13-11"></a>
</span><span id="__span-13-12"><a id="__codelineno-13-12" name="__codelineno-13-12" href="#__codelineno-13-12"></a><span class="w">  </span><span class="c1"># Calculate distance from trendline as percentage</span>
</span><span id="__span-13-13"><a id="__codelineno-13-13" name="__codelineno-13-13" href="#__codelineno-13-13"></a><span class="w">  </span><span class="n">distance_pct</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">((</span><span class="n">price</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">trend_val</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">price</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span>
</span><span id="__span-13-14"><a id="__codelineno-13-14" name="__codelineno-13-14" href="#__codelineno-13-14"></a>
</span><span id="__span-13-15"><a id="__codelineno-13-15" name="__codelineno-13-15" href="#__codelineno-13-15"></a><span class="w">  </span><span class="c1"># Count touches (within 1% of trendline)</span>
</span><span id="__span-13-16"><a id="__codelineno-13-16" name="__codelineno-13-16" href="#__codelineno-13-16"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="n">distance_pct</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">1</span><span class="o">.</span><span class="mi">0</span>
</span><span id="__span-13-17"><a id="__codelineno-13-17" name="__codelineno-13-17" href="#__codelineno-13-17"></a><span class="w">    </span><span class="n">touches</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">1</span>
</span><span id="__span-13-18"><a id="__codelineno-13-18" name="__codelineno-13-18" href="#__codelineno-13-18"></a>
</span><span id="__span-13-19"><a id="__codelineno-13-19" name="__codelineno-13-19" href="#__codelineno-13-19"></a><span class="w">    </span><span class="c1"># Check if price bounced (moved away from trendline)</span>
</span><span id="__span-13-20"><a id="__codelineno-13-20" name="__codelineno-13-20" href="#__codelineno-13-20"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">prices</span><span class="o">.</span><span class="n">size</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span>
</span><span id="__span-13-21"><a id="__codelineno-13-21" name="__codelineno-13-21" href="#__codelineno-13-21"></a><span class="w">      </span><span class="n">next_distance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">((</span><span class="n">prices</span><span class="o">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="o">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">trendline</span><span class="o">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="o">]</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">prices</span><span class="o">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="o">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span>
</span><span id="__span-13-22"><a id="__codelineno-13-22" name="__codelineno-13-22" href="#__codelineno-13-22"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="n">next_distance</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">distance_pct</span>
</span><span id="__span-13-23"><a id="__codelineno-13-23" name="__codelineno-13-23" href="#__codelineno-13-23"></a><span class="w">        </span><span class="n">bounces</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">1</span>
</span><span id="__span-13-24"><a id="__codelineno-13-24" name="__codelineno-13-24" href="#__codelineno-13-24"></a><span class="w">      </span><span class="k">end</span>
</span><span id="__span-13-25"><a id="__codelineno-13-25" name="__codelineno-13-25" href="#__codelineno-13-25"></a><span class="w">    </span><span class="k">end</span>
</span><span id="__span-13-26"><a id="__codelineno-13-26" name="__codelineno-13-26" href="#__codelineno-13-26"></a><span class="w">  </span><span class="k">end</span>
</span><span id="__span-13-27"><a id="__codelineno-13-27" name="__codelineno-13-27" href="#__codelineno-13-27"></a><span class="k">end</span>
</span><span id="__span-13-28"><a id="__codelineno-13-28" name="__codelineno-13-28" href="#__codelineno-13-28"></a>
</span><span id="__span-13-29"><a id="__codelineno-13-29" name="__codelineno-13-29" href="#__codelineno-13-29"></a><span class="n">bounce_rate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">touches</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">(</span><span class="n">bounces</span><span class="o">.</span><span class="n">to_f</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">touches</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">0</span>
</span><span id="__span-13-30"><a id="__codelineno-13-30" name="__codelineno-13-30" href="#__codelineno-13-30"></a><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Trendline touches: </span><span class="si">#{</span><span class="n">touches</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-13-31"><a id="__codelineno-13-31" name="__codelineno-13-31" href="#__codelineno-13-31"></a><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Successful bounces: </span><span class="si">#{</span><span class="n">bounces</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-13-32"><a id="__codelineno-13-32" name="__codelineno-13-32" href="#__codelineno-13-32"></a><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Bounce rate: </span><span class="si">#{</span><span class="n">bounce_rate</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">%&quot;</span>
</span><span id="__span-13-33"><a id="__codelineno-13-33" name="__codelineno-13-33" href="#__codelineno-13-33"></a><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Trendline reliability: </span><span class="si">#{</span><span class="n">bounce_rate</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">60</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;HIGH&#39;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;MODERATE&#39;</span><span class="si">}</span><span class="s2">&quot;</span>
</span></code></pre></div>
<h3 id="volatility-adjusted-trendline-channels">Volatility-Adjusted Trendline Channels<a class="headerlink" href="#volatility-adjusted-trendline-channels" title="Permanent link">&para;</a></h3>
<div class="language-ruby highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="c1"># Create channel around adaptive trendline using ATR</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="n">trendline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SQA</span><span class="o">::</span><span class="no">TAI</span><span class="o">.</span><span class="n">ht_trendline</span><span class="p">(</span><span class="n">prices</span><span class="p">)</span>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="n">atr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SQA</span><span class="o">::</span><span class="no">TAI</span><span class="o">.</span><span class="n">atr</span><span class="p">(</span><span class="n">highs</span><span class="p">,</span><span class="w"> </span><span class="n">lows</span><span class="p">,</span><span class="w"> </span><span class="n">prices</span><span class="p">,</span><span class="w"> </span><span class="ss">period</span><span class="p">:</span><span class="w"> </span><span class="mi">14</span><span class="p">)</span>
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a>
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="c1"># Create upper and lower channel bands</span>
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a><span class="n">channel_width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="o">.</span><span class="mi">0</span><span class="w">  </span><span class="c1"># ATR multiplier</span>
</span><span id="__span-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a>
</span><span id="__span-14-8"><a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a><span class="n">upper_channel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">trendline</span><span class="o">.</span><span class="n">zip</span><span class="p">(</span><span class="n">atr</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="o">|</span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="o">|</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">channel_width</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-14-9"><a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a><span class="n">lower_channel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">trendline</span><span class="o">.</span><span class="n">zip</span><span class="p">(</span><span class="n">atr</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="o">|</span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="o">|</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">channel_width</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-14-10"><a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a>
</span><span id="__span-14-11"><a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a><span class="n">current_price</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">prices</span><span class="o">.</span><span class="n">last</span>
</span><span id="__span-14-12"><a id="__codelineno-14-12" name="__codelineno-14-12" href="#__codelineno-14-12"></a><span class="n">current_trendline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">trendline</span><span class="o">.</span><span class="n">last</span>
</span><span id="__span-14-13"><a id="__codelineno-14-13" name="__codelineno-14-13" href="#__codelineno-14-13"></a><span class="n">current_upper</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">upper_channel</span><span class="o">.</span><span class="n">last</span>
</span><span id="__span-14-14"><a id="__codelineno-14-14" name="__codelineno-14-14" href="#__codelineno-14-14"></a><span class="n">current_lower</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lower_channel</span><span class="o">.</span><span class="n">last</span>
</span><span id="__span-14-15"><a id="__codelineno-14-15" name="__codelineno-14-15" href="#__codelineno-14-15"></a>
</span><span id="__span-14-16"><a id="__codelineno-14-16" name="__codelineno-14-16" href="#__codelineno-14-16"></a><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Adaptive Trendline Channel&quot;</span>
</span><span id="__span-14-17"><a id="__codelineno-14-17" name="__codelineno-14-17" href="#__codelineno-14-17"></a><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Upper Band: </span><span class="si">#{</span><span class="n">current_upper</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-14-18"><a id="__codelineno-14-18" name="__codelineno-14-18" href="#__codelineno-14-18"></a><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Trendline: </span><span class="si">#{</span><span class="n">current_trendline</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-14-19"><a id="__codelineno-14-19" name="__codelineno-14-19" href="#__codelineno-14-19"></a><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Lower Band: </span><span class="si">#{</span><span class="n">current_lower</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-14-20"><a id="__codelineno-14-20" name="__codelineno-14-20" href="#__codelineno-14-20"></a><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Current Price: </span><span class="si">#{</span><span class="n">current_price</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-14-21"><a id="__codelineno-14-21" name="__codelineno-14-21" href="#__codelineno-14-21"></a><span class="nb">puts</span>
</span><span id="__span-14-22"><a id="__codelineno-14-22" name="__codelineno-14-22" href="#__codelineno-14-22"></a>
</span><span id="__span-14-23"><a id="__codelineno-14-23" name="__codelineno-14-23" href="#__codelineno-14-23"></a><span class="c1"># Price position in channel</span>
</span><span id="__span-14-24"><a id="__codelineno-14-24" name="__codelineno-14-24" href="#__codelineno-14-24"></a><span class="k">if</span><span class="w"> </span><span class="n">current_price</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">current_upper</span>
</span><span id="__span-14-25"><a id="__codelineno-14-25" name="__codelineno-14-25" href="#__codelineno-14-25"></a><span class="w">  </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Price ABOVE channel - overextended uptrend&quot;</span>
</span><span id="__span-14-26"><a id="__codelineno-14-26" name="__codelineno-14-26" href="#__codelineno-14-26"></a><span class="w">  </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Consider taking profits or waiting for pullback&quot;</span>
</span><span id="__span-14-27"><a id="__codelineno-14-27" name="__codelineno-14-27" href="#__codelineno-14-27"></a><span class="k">elsif</span><span class="w"> </span><span class="n">current_price</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">current_lower</span>
</span><span id="__span-14-28"><a id="__codelineno-14-28" name="__codelineno-14-28" href="#__codelineno-14-28"></a><span class="w">  </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Price BELOW channel - overextended downtrend&quot;</span>
</span><span id="__span-14-29"><a id="__codelineno-14-29" name="__codelineno-14-29" href="#__codelineno-14-29"></a><span class="w">  </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Consider taking profits or waiting for bounce&quot;</span>
</span><span id="__span-14-30"><a id="__codelineno-14-30" name="__codelineno-14-30" href="#__codelineno-14-30"></a><span class="k">elsif</span><span class="w"> </span><span class="n">current_price</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">current_trendline</span>
</span><span id="__span-14-31"><a id="__codelineno-14-31" name="__codelineno-14-31" href="#__codelineno-14-31"></a><span class="w">  </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Price in UPPER half of uptrend channel&quot;</span>
</span><span id="__span-14-32"><a id="__codelineno-14-32" name="__codelineno-14-32" href="#__codelineno-14-32"></a><span class="w">  </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Healthy uptrend, but approaching resistance&quot;</span>
</span><span id="__span-14-33"><a id="__codelineno-14-33" name="__codelineno-14-33" href="#__codelineno-14-33"></a><span class="k">else</span>
</span><span id="__span-14-34"><a id="__codelineno-14-34" name="__codelineno-14-34" href="#__codelineno-14-34"></a><span class="w">  </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Price in LOWER half of downtrend channel&quot;</span>
</span><span id="__span-14-35"><a id="__codelineno-14-35" name="__codelineno-14-35" href="#__codelineno-14-35"></a><span class="w">  </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Healthy downtrend, but approaching support&quot;</span>
</span><span id="__span-14-36"><a id="__codelineno-14-36" name="__codelineno-14-36" href="#__codelineno-14-36"></a><span class="k">end</span>
</span></code></pre></div>
<h2 id="references">References<a class="headerlink" href="#references" title="Permanent link">&para;</a></h2>
<ul>
<li><strong>"Rocket Science for Traders"</strong> by John F. Ehlers - Comprehensive coverage of Hilbert Transform and adaptive indicators</li>
<li><strong>"Cybernetic Analysis for Stocks and Futures"</strong> by John F. Ehlers - Advanced applications including instantaneous trendline</li>
<li><strong>"Cycle Analytics for Traders"</strong> by John F. Ehlers - Detailed explanation of cycle-adaptive techniques</li>
<li><strong>Original Research</strong>: John F. Ehlers pioneered the application of Hilbert Transform to create adaptive trendlines</li>
<li><strong>TA-Lib Documentation</strong>: <a href="https://ta-lib.org/function.html?name=HT_TRENDLINE">HT_TRENDLINE Function</a></li>
</ul>
<h2 id="see-also">See Also<a class="headerlink" href="#see-also" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="../../">Volatility Indicators Overview</a></li>
<li><a href="../../cycle/">Hilbert Transform Indicators Family</a></li>
<li><a href="../../../examples/adaptive-indicators/">Adaptive Indicators Guide</a></li>
<li><a href="../../../examples/trend-following/">Trend Following Strategies</a></li>
<li><a href="../../../api-reference/">API Reference</a></li>
</ul>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024 Dewayne VanHoozer
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
    <a href="https://github.com/madbomber/sqa-tai" target="_blank" rel="noopener" title="SQA TAI on GitHub" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
    <a href="https://rubygems.org/gems/sqa-tai" target="_blank" rel="noopener" title="SQA TAI on RubyGems" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M116.7 33.8c4.5-6.1 11.7-9.8 19.3-9.8h240c7.6 0 14.8 3.6 19.3 9.8l112 152c6.8 9.2 6.1 21.9-1.5 30.4l-232 256c-4.5 5-11 7.9-17.8 7.9s-13.2-2.9-17.8-7.9l-232-256c-7.7-8.5-8.3-21.2-1.5-30.4zm38.5 39.8c-3.3 2.5-4.2 7-2.1 10.5l57.4 95.7L63.3 192c-4.1.3-7.3 3.8-7.3 8s3.2 7.6 7.3 8l192 16h1.3l192-16c4.1-.3 7.3-3.8 7.3-8s-3.2-7.6-7.3-8l-147.2-12.3 57.4-95.6c2.1-3.5 1.2-8.1-2.1-10.5s-7.9-2-10.7 1l-90 97.6-90.1-97.6c-2.8-3-7.4-3.4-10.7-1"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": ["navigation.instant", "navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.path", "navigation.indexes", "navigation.top", "toc.follow", "search.suggest", "search.highlight", "search.share", "header.autohide", "content.code.copy", "content.code.annotate", "content.tabs.link", "content.tooltips", "content.action.edit", "content.action.view"], "search": "../../../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
        <script src="../../../assets/js/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>